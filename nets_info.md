**Топология сети** - это схема соединения компьютеров в сети.
Представляется в виде графа, где:
Узлы - это вершины (Узлами называют копьютеры и сетевое оборудование).
Рёбра - связь между узлами.

Различают следующие виды топологии:
Полносвязная
Ячеистая (как полносвязная, но некоторые связи удалены)
Звезда (все узлы связаны с центральным устройством)
Кольцо
Дерево
Общая шина
Смешанная топология

# Виды топологии
**Физическая топология** - соединения устройств в сети.
**Логическая топология** - правила распространения сигналов в сети.

Примеры:
классический **Ethernet** имеет физическую топологию **звездв**, поскольку компьютеры подключаются к центральному узлу, но логическую топологию **общая шина**, потому что данные, поступающие на один порт концентратора распространяются на все доступные порты и доступно всем компьютерам в сети.
Коммутируемый **Ethernet** имеет такую же физическую топологию, но логически - **полносвязную**: каждый компьютер может быть соединён напрямую с другим компьютером.
Технология **Wi-Fi** не имеет физическую топологию, а логическую топологию - **общая шина**. Всё, что узел передаёт в радиоэфир доступно всем другим компьютерам, находящимся в зоне действия отправителя.

# Виды стандартов в компьютерных сетях
**De jure** (формальные, юридические) - принятые по формальным законам стандартизации.
Примеры:
ISO (эталонная модель взаимодействия открытых систем),
IEEE (технологии передачи данных, сетевое оборудование),
IAB (протоколы интернет),
W3C (стандарты Web).
Доступны здесь: **https://www.w3.org/standards/**
**De facto** (фактические) - установившиеся сами собой (новые технологии, пользующиеся большой популярностью).

Нас интересует **Internet Engineering Task Force, IETF**, выпускающий стандарты на сетевые протоколы.
он пишет **Request for comments (RFC)** - запросы на комментарии. Содержат в себе:
Документы с описанием работы протоколов
(Формально не называются стандартами (запрос комментариев), но по сути являются таковыми.
Примеры документов:
RFC 791 - протокол IP
RFC 793 - протокол TCP
https://tools.ietf.org/rfc/index

#Основы организации компьютерных сетей

h1. Сложности построения сетей:
Многообразие оборудования и ПО
Надёжность
Развитие сети
Распределение ресурсов
Качество обслуживания
Безопасность

h1. Решение:
Декомпозиция на отдельные подзадачи
Каждый уровень решает одну конкретную задачу или набор связанных задач
Изоляция работ различных уровней

Набор необходимых понятий:
**Сервис** - описывает функционал уровня
**Интерфейс** - набор примитивных операций, которые нижний уровень предоставляет верхнему
Использует реальное взаимодействие внутри компьютера
(Уровень N вызывает уровень N - 1 внутри одного компьютера)
**Протокол** - правила и соглашения, используемые для связи уровня N одного компьютера с уровнем N другого компьютера.
Использует виртуальное взаимодействие между компьютерами
(Реально соединяются друг с другом только уровни, работающие с физической средой)
Виртуальное взаимодействие происходит через заголовки протокола.

**Кратко:**<br>
Сервис - что делает уровень.<br>
Протокол - как уровень это делает.<br>
Интерфейс - как получить доступ к сервису уровня.<br>

**Архитектура сети**:
задаёт набор уровней и протоколов сети.
(Интерфейсы в архитектуру не входят, т. к. могут быть разные на разных программно-аппаратных платформах)

**Стек протоколов** - это иерархически организованный набор протоколов, достаточный для организации взаимодействия по сети.

**Инкапсуляция** - включение сообщения вышестоящего уровня в сообщение нижестоящего уровня.
Сообщение строится по типу: заголовок + данные + концевик (необязательный).

#Модель OSI
Это одна из эталонных моделей организации сети, решающая вопросы:
* Какие уровни долдны быть в сети?
* Какие функции должны выполняться на каждом уровне?

Модель OSI расшифровывается как Open System Interconnection (Модель взаимодействия открытых систем).

**Открытая система** - система, построенная в соответствии с открытыми спецификациями.
**Открытая спецификация** - общедоступная спецификация, соответствующая стандартам.

**Преимущества открытых систем**
* Возможность строить сети из оборудования разных производителей
* "Безболезненная" замена отдельных компонентов сети
* Лёгкость объединения нескольких сетей

Модель OSI используется в качестве "общего языка" для описания разных сетей
Включает 7 уровней организации сети и их назначение
(Протоколы не включены в модель)

<details>
    <summary>Уровни:</summary>
**Application**
Набор приложений
Единица передаваемых данных:
Сообщение
**Presentation**
Предоставлять данные в том виде, который понятен и отправителю, и получателю.
Обеспечивает согласование синтаксиса и семантики передаваемых данных.
* Форматы представления символов
* Форматы чисел
Шифрование и дешифрование
Examples: TLS, SSL
Единица передаваемых данных:
Сообщение
**Session**
Позволяет устанавливать сеансы связи
Задачи:
Управление диалогом (определяет очерёдность передачи сообщений)
Управление маркерами (предотвращение одновременного выполнения критичной операции, транзакции)
Синхронизация (защита от разрыва сетевого соединения и возможность возобновления передачи при восстановлении соединения)
Единица передаваемых данных:
Сообщение
**Transport**
Обеспечивает передачу данных между процессами на хостах
Единица передаваемых данных:
Сегмент/Дейтаграмма
**Network**
Объединяет сети, построенные на основе разных технологий
Задачи:
создание составной сети
Адресация,
**Маршрутизация** - определение маршрута пересылки пакетов в составной сети.
Единица передаваемых данных:
Пакет
**Data Link**
Передача сообщений: определение начала/конца сообщения в потоке бит
Физическая адресация
Единица передаваемых данных:
Кадр
**Physical**
передача битов по физическому каналу связи
Задача: представление бит информации в виде сигналов, передаваемых по среде
Единица передаваемых данных:
Бит
</details>

На разных уровнях модели OSI работает разное оборудование:
Сетевой - Маршрутизатор
Канальный - Коммутатор, точка доступа
Физический - Концентратор

#Модель TCP/IP
Фактический стандарт (de facto).

Прикладной
Транспортный
Интернет
Сетевых интерфейсов

Есть разновидность, известная как "Пятиуровневая модель OSI + TCP/IP":
Прикладной
Транспортный
Сетевой
Канальный
Физический

Описана у Таненбаума, Уэзеролла в книге "Компьютерные сети".
Считается что эта модель ближе всего к тому, что сейчас используется на практике.

#Физический уровень
**Сервис** - передача потока бит по среде передачи данных.
Не вникает в смысл передаваемой информации.
Единица передачи информации - бит.
**Основная задача** - зпредставить биты информации в виде сигналов, передаваемых по среде.
Различают следующие **характеристики канала связи**:
* **Пропускная способность** (бит/с)
* **Задержка** - за сколько времени сообщение доходит от отправителя до получателя
Совместно пропускная способность и задержка характеризуют **скорость работы канала**.
* **Количество ошибок**

**Типы каналов связи**:
* **Симплексный** - данные можно передавать только в одну сторону
* **Дуплексный** - данные можно передавать в обе стороны
* **Полудуплексный** - данные также можно передавать в обе стороны, но по очереди

**Среды передачи данных**
* Кабель:
Витая пара
Оптоволокно
Провода электропитания 220В и т. д.
* Беспроводные технологии:
Радиоволны
Инфракрасное излучение
* Спутниковые каналы
* Беспроводная оптика (лазеры)

**Особенности беспроводной сети**:
* Сигнал передаётся по нескольким направлениям
* Один и тот же сигнал могут принимать несколько приёмников
* Несколько источников сигнала искажают друг друга и требуют координации работы

Поэтому используемые диапазоны регулируются законодательством:
Пример:
Сотовая связь (GSM) - 900 МГц
Wi-Fi: 2,4 ГГц и 5 ГГц
Но другие приборы также работают на этой частоте. Поэтому роутер, расположенный рядом с микроволновкой - не очень хорошая идея.

Среда передачи данных   Частота возникновения ошибок
Оптические кабели       Очень редко
Медные кабели           Редко
Радиоволны              Часто

**Представление информации** также различается:
В медных проводах используется **кодирование**, т. н. прямоугольные импульсы
0 - отсутствие напряжения, 1 - напряжение, но на практике используются более сложные схемы.
**baseband modulation**

В оптоволокне и беспроводной среде используется **модуляция**, т. н. синусоидальные волны
**passband modulation**

#Физический уровень
**Основная задача** - передача сообщений по каналам связи - кадров (frame)
Также на этом уровне:
* определяется точка начала/конца кадра в потоке бит
* происходит обнаружение и коррекция ошибок

Если на канале связи есть несколько устройств, то здесь также решаются следующие вопросы:
* Адресация
* Согласованный доступ к каналу

Канальный уровень получает с сетевого уровня пакет данных.
Затем он добавляет к нему **Заголовок** и **Концевик**, формируя из пакета таким образом **кадр**.
Затем данное сообщение передаётся по среде передачи данных и поступает на канальный уровень принимающего хоста.
В результате на канальном уровне принимающего хоста расшифровываются Заголовок и Концевик и извлечённый **пакет данных** передаётся выше на сетевой уровень.

##Методы выделения кадров##

**Указатель количества байт**

Например, самый простой способ указать начало и конец кадра: в начале каждого кадра указывать его длину в байтах.
Другой метод - вставка в начало и конец каждого кадра особой последовательности байтов или бит, например:
**Протокол BSC** использует текстовые символы:
* DLE STX - начало кадра (Start of TeXt)
* DLE ETX - конец кадра (End of TeXt)
* Escape последовательность в данных - DLE (Data Link Escape)
**Протоколы HDLC и PPP** используют биты:
* 01111110 - начало и каонец кадра
* В данных после пяти последовательных единиц добавлялся 0 для избежания случайного совпадения в теле сообщения вышеупомянутой комбинации бит
* Получатель, в свою очередь после пяти последовательных единиц игнорировал 0

**bit/byte stuffing** (вставка битов/байтов)

**Средства физического уровня**
Преамбула (классический Ethernet)
* Длина 8 байт
* Первые 7 байт: 10101010
* Последний байт: 10101011 (ограничитель начала кадра)

Передача неиспользуемых символов избыточного кода (Fast Ethernet)
* Начало кадра - пара символы J (11000) и K (10001)
* Конец кадра - символ T (01101)

##Варианты обнаружения и исправления ошибок##
**Обнаружение ошибок:**
* Контрольная сумма
Самый простой способ - просто отбросить кадр с нарушенной контрольной суммой

**Исправление ошибок**
* Коды исправляющие ошибки (с избыточной информацией)
* Позволяют обнаруживать и исправлять ошибки

**Повторная отправка данных**
* Если в кадре обнаружена ошибка, его можно отправить заново
Используется совместно с обнаружением ошибок.
* Повторная отправка кадра, который не дошёл до получателя

Есть два варианта метода повторной отправки:
**Остановка и ожидание**
* Отправитель передаёт кадр и останавливает передачу
* Получатель отправляет подтверждение
* Отправитель передаёт новый кадр
У отправителя есть таймаут, если за время ожидания таймаут истёк и подтверждения не пришло - необходимо отправить кадр повторно.
Такая технология используется в Wi-Fi.

**Скользящее окно**
* Отправитель передаёт несколько кадров один за другим, не дожидаясь подтверждения
* Количество кадров, которое можно отправить, называется **размером окна**
* Получатель подтверждает получение кадров (для последнего полученного сообщения)
* Отправитель передаёт новую порцию кадров
(Используется на транспортном уровне в протоколе TCP)

На практике обнаруживать, исправлять ошибки и осуществлять повторную отправку данных можно на разных уровнях:
* Каналы связи с редкими ошибками (например, кабель, волокно) - на верхних уровнях
* Каналы связи с частыми ошибками (например Wi-Fi) - на канальном уровне

Модель OSI разрабатывалась для каналов связи точка-точка
(последовательные линии связи для соединения больших компьютеров)

Когда получили распространение разделяемые каналы связи, модель пришлось изменить.

Канальный уровень был разделён на два подуровня:

**Подуровень управления логическим каналом (Logical Linc Control, LLC)**
* Отвечает за передачу данных (создание кадров, обработка ошибок и т. д.)
* Общий для разных технологий

**Подуровень управления доступом к среде (Media Access Control, MAC)**
* Совместное использование разделяемой среды
* Адресация
* Специфичный для разных технологий
* Не является обязательным (для формата точка-точка, например)

Также подуровень LLC способен осуществлять:
**Мультиплексирование**
* Передача данных разных протоколов (IP, ARP, ICMP) на уровень MAC (через канальный уровень)

**Управление потоком:**
* Предотвращение "затопления" медленного получателя быстрым отправителем
(Если в сети устройства, работающие с разной скоростью, возможна ситуация, когда более быстрое и мощное устройство начинает передавать огромный и быстрый объём данных медленному получателю, "затапливая" его.

##Согласованный доступ к разделяемому каналу связи##

**Управление доступом**:
* Обеспечение использования канала только одним отправителем в один и тот же момент времени
в противном случае произойдёт **коллизия** (данные искажаются, если несколько компьютеров передают одновременно)

**Методы управления доступом**:
* Рандомизированный - из N компьютеров выбирается один с вероятностью 1/N. (Ethernet, Wi-Fi)
* На основе правил использования. (Token Ring)

#Ethernet#
Две технологии Ethernet:

**Классический Ethernet**
* Разделяемая среда
* Ethernet - Gigabit Ethernet

<details>
    <summary>Уровни:</summary>
Ethernet            10 MB/s     802.3
Fast Ethernet       100 MB/s    802.3u
Gigabit Ethernet    1 Gb/s      802.3z, 802.3ab
</details>

**Коммутируемый Ethernet**
* Точка-точка
* Появился в Fast Ethernet
* Единственный вариант в 10G Ethernet и выше

Почти всё современное оборудование поддерживает обе технологии.

##Классический Ethernet##
Исторически - самый первый.
Общая шина - коаксиальный кабель
К каждому компьютеру подключался т-коннектор, соединяющий его с общей шиной.
Минусы - разрыв в одном месте приводил к повреждению всей сети в целом.

Следующий этап технологии - **hub** или **концентратор**
Устройство для создания сетей Ethernet на основе **витой пары**

Физическая топология - **звезда**.
Логическая топология - **общая шина**, так как сигнал, поступающий на один порт концентратора передаётся на все остальные порты.

Преимущества:
если выйдет из строя кабель или сетевой адаптер - сеть перестаёт работать только на одном компьютере.
На основе цветовой индикации легко найти источник, где нет линка.

**Физический уровень Ethernet**
Технология Ethernet содержит описание передачи сигналов по трём разным типам кабелей:
* Коаксиальный
* Витая пара
* Оптоволокно

**Канальный уровень Ethernet**
* Методы доступа и протоколы, одинаковые для любой среды передачи данных
* В классическом Ethernet смешаны подуровни LLC и MAC

На канальном уровне для передачи данных используются кадры.
Есть три стандарта реализации кадра:
* Экспериментальная реализация Ethernet в Xerox (сейчас почти не используется)
* Ethernet II (Ethernet DIX) - фирменный стандарт Ethernet компаний DEC, Intel, Xerox
* IEEE 802.3 - юридический стандарт Ethernet

Стандарты Ethernet II и IEEE 802.3 незначительно отличаются друг от друга
* Ethernet II используется чаще.

#Формат кадра Ethernet
6 байт      6 байт      2 байта     46-1500 байт    4 байта
Адрес       Адрес       Тип         Данные          Контрольная сумма
получателя  отправителя документа
                        0800 - IPv4
                        86DD - IPv6
                        0806 - ARP
                        etc
Header      Header      Header      Body            Концевик

Поле данные от протокола верхнего уровня:
Максимальная длина 1500 байт,
* Выбрана разработчиками Ethernet
* Ограничение на размер памяти для буфера
* Существует расширение JumboFrame (до 9000 байт)

Минимальная длина 46 байт
* Ограничение технологии Ethernet

#MAC адреса.
Используется на подуровне канального уровня: Media Access Control
Регламентированы стандартом IEEE 802
Наиболее популярны:
Ethernet    (IEEE 802.3)
Wi-Fi       (IEEE 802.11)
**Длина MAC-адреса**
6 байт (48 бит)
**Форма записи** - шесть шестнадцатеричных чисел:
примеры:
* 1C-75-08-D2-49-45
* 1C:75:08:D2:49:45

**Типы MAC-адресов**Ж
1. Индивидуальный (unicast):
* 30-9C-23-15-E8-8C
2. Групповой (multicast, первый бит старшего байта адреса равен 1):
* 01-80-C2-00-00-08
(Передача осуществляется на группу устройств. На этих устройствах должен быть настроен multicast).
3. Широковещательный (broadcast, все 1):
* FF-FF-FF-FF-FF-FF

**Уникальность MAC-адресов**
В одном сегменте сети не должно быть одинаковых MAC-адресов.
* Одна широковещательная среда Ethernet или Wi-Fi
* Один VLAN в коммутируемом Ethernet

Если будет два компьютера с одним MAC-адресом, то один из них не будет работать
* Какой именно не регламентируется

**Способы назначения адресов**
1. Централизованный (по умолчанию) - производителем оборудования согласно стандартам IEEE 802.
2. Локальный - администратором сети, администратор обеспечивает уникальность.

Индикатор способа назначения - второй бит старшего байта MAC-адреса:
- 0 - адрес назначен централизованно
- 1 - адрес назначен локально

Структура централизованного MAC-адреса:
* Первые 3 байта - уникальный идентификатор организации (Organizationally Unique Identifier, OUI), выдаются производителям оборудования.
Примеры:
* 00:00:0C - Cisco
* 00:02:B3 - Intel
* 00:04:AC - IBM
* Последние 3 байта - назначает производитель оборудования, который отвечает за уникальность.
