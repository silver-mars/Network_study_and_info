# History

С одной стороны, компьютерные сети представляют собой группу компьютеров, согласованно решающих набор взаимосвязанных задач, обмениваясь данными в автоматическом режиме.
С другой стороны, компьютерные сети могут рассматриваться как средство передачи информации на большие расстояния, для чего в них применяются методы кодирования и мультиплексирования данных, получившие развитие в различных телекоммуникационных системах, например телефонных сетях.

Многотерминальные системы, работающие в режиме разделения времени, стали прообразом локальных вычислительных сетей.

Затем появились системы, в которых наряду с удаленными соединениями типа терминал — компьютер были реализованы и удаленные связи типа компьютер — компьютер.
Разнесенные территориально компьютеры получили возможность обмениваться данными в автоматическом режиме, что, собственно, и является базовым признаком любой вычислительной сети.

Хронологически первыми появились глобальные сети (Wide Area Network, WAN), то есть сети, объединяющие территориально рассредоточенные компьютеры, возможно, находящиеся в различных городах и странах.

Сеть ARPANET объединяла компьютеры разных типов, работавшие под управлением различных операционных систем (ОС) с дополнительными модулями, реализующими коммуникационные протоколы, общие для всех компьютеров сети. ОС этих компьютеров можно считать первыми сетевыми операционными системами.

Любая сетевая операционная система, с одной стороны, выполняет все функции локальной операционной системы, а с другой стороны, обладает некоторыми дополнительными средствами, позволяющими ей взаимодействовать через сеть с операционными системами других компьютеров. 

В результате технологического прорыва в области производства компьютерных компонентов появились большие интегральные схемы (БИС). Их сравнительно невысокая стоимость и хорошие функциональные возможности привели к созданию мини-компьютеров.
Даже небольшие подразделения предприятий получили возможность иметь собственные компьютеры. Мини-компьютеры решали задачи управления технологическим оборудованием, складом и другие задачи уровня отдела предприятия. Таким образом, появилась концепция распределения компьютерных ресурсов по всему предприятию. 

# Termins

**Локальные сети** (Local Area Network, LAN) — это объединения компьютеров, сосредоточенных на небольшой территории, обычно в радиусе не более 1–2 км, хотя в отдельных случаях локальная сеть может иметь и большие размеры, например, несколько десятков километров Обычно локальная сеть представляет собой коммуникационную систему, принадлежащую одной организации.

**Сетевая технология** — это согласованный набор программных и аппаратных средств (например, драйверов, сетевых адаптеров, кабелей и разъемов), а также механизмов передачи данных по линиям связи, достаточный для построения вычислительной сети.

Исторически главной целью объединения компьютеров в сеть было разделение ресурсов.
Для связи устройств в них прежде всего должны быть предусмотрены внешние интерфейсы.
**Интерфейс** — в широком смысле — формально определенная логическая и/или физическая граница между отдельными объектами, которые обмениваются информацией. Интерфейс задает параметры, процедуры и характеристики взаимодействия объектов.

**Физический интерфейс** (называемый также портом) определяется набором электрических связей и характеристиками сигналов. Обычно он представляет собой разъем с набором контактов, каждый из которых имеет определенное назначение, например, это может быть группа контактов для передачи данных, контакт синхронизации данных и т. п.
Пара разъемов соединяется кабелем, состоящим из набора проводов, каждый из которых соединяет соответствующие контакты. В таких случаях говорят о создании линии, или канала, связи между двумя устройствами.
**Логический интерфейс** (называемый также протоколом) — это набор информационных сообщений определенного формата, которыми обмениваются два устройства или две программы, а также набор правил, определяющих логику обмена этими сообщениями.

Интерфейс компьютер — компьютер позволяет двум компьютерам обмениваться информацией. С каждой стороны он реализуется парой:
* **аппаратным модулем**, называемым сетевым адаптером или **сетевой интерфейсной картой (ИК)**, или (в англоязычном варианте) Network Interface Card, NIC;
* **драйвером сетевой интерфейсной карты** — специальной программой, управляющей работой сетевой интерфейсной карты.

**Клиент** — это модуль, предназначенный для формирования и передачи сообщений-запросов к ресурсам удаленного компьютера от разных приложений с последующим приемом результатов из сети и передачей их соответствующим приложениям.
**Сервер** — это модуль, который постоянно ожидает прихода из сети запросов от клиентов и, приняв запрос, пытается его обслужить, как правило, с участием локальной ОС; один сервер может обслуживать запросы сразу нескольких клиентов (поочередно или одновременно).
**Пара клиент-сервер**, предоставляющая доступ к конкретному типу ресурса компьютера через сеть, образует **сетевую службу**.

Каждая служба связана с определенным типом сетевых ресурсов.

Услуги, предоставляемые службой, называются **сервисом**.

Пример: сервисы аудита, аутентификации, авторизации и др.

**Web as example**
Для поиска и просмотра информации в Интернете используется веб-служба, состоящая из веб-сервера и клиентской программы, называемой веб-браузером (web browser). Разделяемым ресурсом в данном случае является веб-сайт — определенным образом организованный набор файлов, содержащих связанную в смысловом отношении информацию и хранящихся на внешнем накопителе веб-сервера.

Усложнение среды передачи сообщений приводит к возникновению новых дополнительных задач, на решение которых не был рассчитан упоминавшийся ранее простейший драйвер сетевой интерфейсной карты. Вместо него на взаимодействующих компьютерах должны быть установлены более развитые программные транспортные средства.

Операционную систему компьютера часто определяют как взаимосвязанный набор системных программ, который обеспечивает эффективное управление ресурсами компьютера (памятью, процессором, внешними устройствами, файлами и др.), а также предоставляет пользователю удобный интерфейс для работы с аппаратурой компьютера и разработки приложений.
Говоря о сетевой ОС, мы, очевидно, должны расширить границы управляемых ресурсов за пределы одного компьютера.
Сетевой операционной системой называют операционную систему компьютера, которая, помимо управления локальными ресурсами, предоставляет пользователям и приложениям возможность эффективного и удобного доступа к информационным и аппаратным ресурсам других компьютеров сети.

Помимо сетевых служб сетевая ОС включает программные коммуникационные (транспортные) средства, обеспечивающие совместно с аппаратными коммуникационными средствами передачу сообщений, которыми обмениваются клиентские и серверные части сетевых служб.
Задачу коммуникации между компьютерами сети решают драйверы и протокольные модули.
Они выполняют такие функции, как формирование сообщений, разбиение сообщения на части (пакеты, кадры), преобразование имен компьютеров в числовые адреса, дублирование сообщений в случае их потери, определение маршрута в сложной сети и т. д.

Сетевая служба может быть представлена в ОС либо обеими (клиентской и серверной) частями, либо только одной из них.

В первом случае операционная система, называемая **одноранговой**, не только позволяет обращаться к ресурсам других компьютеров, но и предоставляет собственные ресурсы в распоряжение пользователей других компьютеров. Например, если на всех компьютерах сети установлены и клиенты, и серверы файловой службы, то все пользователи сети могут совместно использовать файлы друг друга. Компьютеры, совмещающие функции клиента и сервера, называют одноранговыми узлами.

Операционная система, которая содержит преимущественно клиентские части сетевых служб, называется **клиентской**. Клиентские ОС устанавливаются на компьютеры, обращающиеся с запросами к ресурсам других компьютеров сети. За такими компьютерами, также называемыми клиентскими, работают рядовые пользователи. Обычно клиентские компьютеры относятся к классу относительно простых устройств.

К другому типу операционных систем относится **серверная** ОС — она ориентирована на обработку запросов из сети к ресурсам своего компьютера и включает в себя в основном серверные части сетевых служб. Компьютер с установленной на нем серверной ОС, занимающийся исключительно обслуживанием запросов других компьютеров, называют выделенным сервером сети.

На компьютере, подключенном к сети, могут запускаться приложения нескольких типов:
* **Локальное приложение** целиком выполняется на данном компьютере и использует только локальные ресурсы.
* **Централизованное сетевое приложение** целиком выполняется на данном компьютере, но обращается в процессе своей работы к ресурсам других компьютеров сети.
* **Распределенное (сетевое) приложение** состоит из нескольких взаимодействующих частей, каждая из которых выполняет какую-то определенную законченную работу по решению прикладной задачи, причем каждая часть может выполняться и, как правило, выполняется на отдельном компьютере сети.

# Характеристики физических каналов

* **Предложенная нагрузка** — это поток данных, поступающий от приложения пользователя на вход сети, которая всегда готова принять данные. Предложенную нагрузку можно характеризовать скоростью генерации данных в битах в секунду.
* **Пропускная способность**, называемая также емкостью канала связи (capacity), представляет собой максимально возможную скорость передачи информации по данному каналу.
* **Скорость передачи данных** (information rate, или throughput, оба английских термина используются равноправно) — это фактическая скорость потока данных, прошедшего через сеть или некоторые ее фрагменты.
Скорость информационного потока, называемая также скоростью передачи данных, определяется как частное от деления объема данных, переданных за некоторый интервал времени, на величину этого интервала.
Из определения следует, что эта характеристика всегда является усредненной. Она отражает как скорость поступления данных в сеть — предложенную нагрузку, так и скоростные свойства физических каналов — пропускную способность сети. Скорость передачи данных может быть ниже предложенной нагрузки, так как данные в сети могут искажаться или теряться, или на некоторых участках выше — когда предварительно буферизованные данные передаются скоростным каналом.

**Типы физических каналов связи:**
* **Дуплексный канал** обеспечивает одновременную передачу информации в обоих направлениях. Дуплексный канал может состоять из двух физических сред, каждая из которых используется для передачи информации только в одном направлении.  Возможен вариант, когда одна среда служит для одновременной передачи встречных потоков. При этом применяют дополнительные методы выделения каждого потока из суммарного сигнала.
* **Полудуплексный канал** также обеспечивает передачу информации в обоих направлениях, но не одновременно, а по очереди. То есть в течение определенного периода времени информация передается в одном направлении, а в течение следующего периода — в обратном.
* **Симплексный канал** позволяет передавать информацию только в одном направлении. Часто дуплексный канал состоит из двух симплексных каналов.

Под **топологией сети** понимается конфигурация графа, вершинам которого соответствуют конечные узлы сети (например, компьютеры) и коммуникационное оборудование (например, маршрутизаторы), а ребрам — физические или информационные связи между вершинами.

Рассматривают следующие топологии:
* Полносвязная,
* Ячеистая,
* Кольцевая,
* Звездообразная,
* Иерархическая звезда (дерево),
* Общая шина (частный случай),
* Смешанная топология.

Адресация узлов сети (адресация сетевых интерфейсов).
* Unicast,
* Multicast,
* Broadcast,
* Anycast.

Множество всех адресов, которые являются допустимыми в рамках некоторой схемы адресации, называется **адресным пространством**. Адресное пространство может иметь плоскую (линейную) или иерархическую организацию.

При **централизованном подходе** в сети выделяется один или несколько компьютеров (серверов имен), в которых хранится таблица соответствия имен различных типов — например, символьных имен и числовых адресов. Все остальные компьютеры обращаются к серверу имен с запросами, чтобы по символьному имени найти числовой номер необходимого компьютера.
При **распределенном подходе** каждый компьютер сам хранит все назначенные ему адреса разного типа. Тогда компьютер, которому необходимо определить по известному иерархическому числовому адресу некоторого компьютера его плоский аппаратный адрес, посылает в сеть широковещательный запрос. Все компьютеры сети сравнивают содержащийся в запросе адрес с собственным. Тот компьютер, у которого обнаружилось совпадение, посылает ответ, содержащий искомый аппаратный адрес. Такая схема использована в протоколе разрешения адресов (Address Resolution Protocol, ARP) стека TCP/IP.

Достоинство распределенного подхода состоит в том, что он позволяет отказаться от выделения специального компьютера в качестве сервера имен, который к тому же часто требует ручного задания таблицы соответствия адресов. Недостатком его является необходимость широковещательных сообщений, перегружающих сеть. Именно поэтому распределенный подход используется в небольших сетях, а централизованный — в больших.

# Commutation

Соединение конечных узлов через сеть транзитных узлов называют коммутацией. Последовательность узлов, лежащих на пути от отправителя к получателю, образует маршрут.

В самом общем виде задача коммутации может быть представлена в виде следующих взаимосвязанных частных задач:
1. Определение информационных потоков, для которых требуется прокладывать маршруты.
2. Маршрутизация потоков — прокладка маршрутов.
3. Продвижение потоков, то есть распознавание потоков и их локальная коммутация на каждом транзитном узле.
4. Мультиплексирование и демультиплексирование потоков.

## Определение информационных потоков
**Информационным потоком**, или потоком данных, называют непрерывную последовательность данных, объединенных набором общих признаков, выделяющих эти данные из общего сетевого трафика.
Например, как поток можно определить все данные, поступающие от одного компьютера; объединяющим признаком в данном случае служит адрес источника. Эти же данные можно представить как совокупность нескольких подпотоков, каждый из которых в качестве дифференцирующего признака имеет адрес назначения.

При коммутации в качестве обязательного признака выступает адрес назначения данных.
На основании этого признака весь поток входящих в транзитный узел данных разделяется на подпотоки, каждый из которых передается на интерфейс, соответствующий тому или иному маршруту продвижения данных.

Метка потока — это особый тип признака. Она представляет собой некоторое число, которое несут все данные потока. Глобальная метка назначается данным потока и не меняет своего значения на всем протяжении его пути следования от узла источника до узла назначения, таким образом, она уникально определяет поток в пределах сети. В некоторых технологиях используются локальные метки потока, динамически меняющие свое значение при передаче данных от одного узла к другому.
Таким образом, распознавание потоков во время коммутации происходит на основании признаков, в качестве которых, помимо обязательного адреса назначения данных, могут выступать и другие признаки — такие, например, как идентификаторы приложений.

## Маршрутизация

Задача маршрутизации, в свою очередь, включает в себя две подзадачи:
* определение маршрута;
* оповещение сети о выбранном маршруте.
Определить маршрут означает выбрать последовательность транзитных узлов и их интерфейсов, через которые надо передавать данные, чтобы доставить их адресату.

Абстрактная оценка условного «расстояния» между двумя узлами сети называется **метрикой**. Так, для измерения длины маршрута могут быть использованы разные метрики — количество транзитных узлов, как в предыдущем примере, линейная протяженность маршрута и даже его стоимость в денежном выражении.

После того как маршрут определен (вручную или автоматически), надо оповестить о нем все устройства сети. Сообщение о маршруте должно нести каждому транзитному устройству примерно такую информацию: «каждый раз, когда в устройство поступят данные, относящиеся к потоку n, их следует передать для дальнейшего продвижения на интерфейс if1». Каждое подобное сообщение о маршруте обрабатывается транзитным устройством, в результате создается новая запись в **таблице коммутации** (называемой также **таблицей маршрутизации**) данного устройства. В этой таблице локальному или глобальному признаку (признакам) потока (например, метке, номеру входного интерфейса или адресу назначения) ставится в соответствие номер интерфейса, на который устройство должно передавать данные, относящиеся к этому потоку.

## Продвижение данных

Для каждой пары абонентов эта операция может быть представлена несколькими (по числу транзитных узлов) локальными операциями коммутации. Прежде всего отправитель должен выставить данные на тот свой интерфейс, с которого начинается найденный маршрут, а все транзитные узлы должны соответствующим образом выполнить «переброску» данных с одного своего интерфейса на другой, другими словами, выполнить **коммутацию интерфейсов**. Устройство, функциональным назначением которого является коммутация, называется **коммутатором**.

**Интерфейс коммутатора** (называемый также **портом**) является физическим модулем, состоящим из приемника и передатчика. В том случае, когда передатчик и приемник работают на дуплексный канал связи, они работают независимо друг от друга, обеспечивая одновременную передачу данных в обоих направлениях. Иногда приемную часть интерфейса называют **входным интерфейсом**, а выходную часть — **выходным интерфейсом**.

Коммутатором может быть как специализированное устройство, так и универсальный компьютер со встроенным программным механизмом коммутации, в этом случае коммутатор называется **программным**.

Во многих случаях более рациональным является решение, в соответствии с которым некоторые узлы в сети выделяются специально для коммутации. Эти узлы образуют **коммутационную сеть**, к которой подключаются все остальные.

**Мультиплексирование** (агрегирование) — образование из нескольких отдельных потоков общего агрегированного потока, который передается по одному физическому каналу связи.
Другими словами, мультиплексирование — это способ разделения одного имеющегося физического канала между несколькими одновременно протекающими сеансами связи абонентов сети.

**Демультиплексирование** — разделение суммарного потока на несколько составляющих его потоков.

Одним из основных способов мультиплексирования потоков является разделение времени.
Распространено также частотное разделение канала, когда каждый поток передает данные в выделенном ему частотном диапазоне.

Частный случай коммутатора, у которого все входящие информационные потоки коммутируются на один выходной интерфейс, где они мультиплексируются в один агрегированный поток, называется **мультиплексором**. Коммутатор, который имеет один входной интерфейс и несколько выходных, называется **демультиплексором**.

**Разделяемой средой** (shared medium) называется физическая среда передачи данных, к которой непосредственно подключено несколько передатчиков узлов сети. Причем в каждый момент времени только один из передатчиков какого-либо узла сети получает доступ к разделяемой среде и использует ее для передачи данных приемнику другого узла, подключенному к этой же среде.

Существуют различные способы решения задачи организации совместного доступа
к разделяемым линиям связи. Одни из них подразумевают централизованный подход, когда доступом к каналу управляет специальное устройство — **арбитр**, другие — децентрализованный. Если мы обратимся к организации работы компьютера, то увидим, что доступ к системной шине компьютера, которую совместно используют внутренние блоки компьютера, управляется централизованно — либо процессором, либо специальным арбитром шины.

# Chapter 3. Коммутация каналов и пакетов

## Коммутация каналов
Сеть с коммутацией каналов представляет собой множество коммутаторов и конечных узлов — **абонентов**, соединенных между собой **линиями (звеньями) связи**. Заметим, что в данном контексте термин **«линия связи»** используется для обозначения соединения двух соседних узлов сети.

### Элементарный канал
Одной из особенностей сетей с коммутацией каналов является использование понятия «элементарный канал».
**Элементарный канал** — это базовая техническая характеристика сети с коммутацией каналов, представляющая собой некоторое фиксированное в пределах данного типа сетей значение пропускной способности. Любая линия связи в сети с коммутацией каналов имеет пропускную способность, кратную элементарному каналу, принятому для данного типа сети.

Говоря о сетях с коммутацией каналов, мы придаем термину «канал» значение
**единицы пропускной способности**.
Особенностью сетей с коммутацией каналов является то, что **пропускная способность каждой линии связи** должна быть равна целому числу элементарных каналов.

### Составной канал
Канал, построенный путем коммутации (соединения) выделенных для информационного потока элементарных каналов, называют **составным каналом**.

Свойства составного канала:
* составной канал на всем своем протяжении состоит из одинакового количества элементарных каналов;
* составной канал имеет постоянную и фиксированную пропускную способность на всем своем протяжении;
* составной канал создается временно на период сеанса связи двух абонентов или, другими словами, только на время существования потока;
* на время сеанса связи все элементарные каналы, входящие в составной канал, поступают в исключительное пользование абонентов, для которых был создан этот составной канал;
* в течение всего сеанса связи абоненты могут посылать в сеть данные со скоростью, не превышающей пропускную способность составного канала;
* данные, поступившие в составной канал, гарантированно доставляются вызываемому абоненту без задержек, потерь и с той же скоростью (скоростью источника) вне зависимости от того, существуют ли в это время в сети другие соединения или нет;
* после окончания сеанса связи элементарные каналы, входившие в соответствующий составной канал, объявляются свободными и возвращаются в пул распределяемых ресурсов для использования другими абонентами.

Таким образом, продвижение данных в сетях с коммутацией каналов происходит в два этапа:
1. В сеть поступает служебное сообщение — запрос, который несет адрес вызываемого абонента и инициирует создание составного канала.
2. По подготовленному составному каналу передается основной поток данных, для передачи которого уже не требуется никакой вспомогательной информации, в том числе адреса вызываемого абонента. Коммутация данных в коммутаторах выполняется на основе локальных признаков потока — номеров выделенных ему элементарных каналов.

## Коммутация пакетов
Важнейшим принципом функционирования сетей с коммутацией пакетов является представление информации, передаваемой по сети, в виде структурно отделенных друг от друга порций данных, называемых **пакетами**.

Каждый пакет снабжен **заголовком**, в котором содержится адрес назначения и другая вспомогательная информация (длина поля данных, контрольная сумма и др.), используемая для доставки пакета адресату. Наличие адреса в каждом пакете является одной из важнейших особенностей техники коммутации пакетов, так как каждый пакет может быть обработан коммутатором независимо от других пакетов, составляющих сетевой трафик. Помимо заголовка у пакета может иметься еще одно дополнительное поле, размещаемое в конце пакета и поэтому называемое **концевиком**. В концевике обычно помещается **контрольная сумма**, которая позволяет проверить, была ли искажена информация при передаче через сеть или нет.

### Буферизация пакетов
Главное отличие пакетных коммутаторов от коммутаторов в сетях с коммутацией каналов состоит в том, что они имеют внутреннюю **буферную память** для временного хранения пакетов.

Каждый пакет последовательно, бит за битом, помещается во **входной буфер**. Имея в виду это свойство, говорят, что сети с коммутацией пакетов используют **технику сохранения с продвижением** (store-and-forward).
Коммутатору нужны буферы, в частности, **для согласования скоростей передачи данных в линиях связи**, подключенных к его интерфейсам.

Буферизация необходима пакетному коммутатору и **для согласования скорости поступления пакетов со скоростью их коммутации**. Если коммутирующий блок не успевает обрабатывать пакеты (анализировать заголовки и перебрасывать пакеты на нужный интерфейс), то на интерфейсах коммутатора возникают **входные очереди**.

Поскольку объем буферов в коммутаторах ограничен, иногда происходит **потеря пакетов** из-за переполнения буферов при временной перегрузке части сети, когда, например, совпадают периоды пульсации нескольких информационных потоков.

Пакетный коммутатор может работать на основании одного из **трех методов продвижения пакетов**:
* дейтаграммная передача;
* передача с установлением логического соединения;
* передача с установлением виртуального канала.

### Дейтаграммная передача
**Дейтаграммный способ передачи данных** основан на том, что все передаваемые пакеты продвигаются (передаются от одного узла сети другому) независимо друг от друга на основании одних и тех же правил. Никакая информация об уже переданных пакетах сетью не хранится и в ходе обработки очередного пакета во внимание не принимается. То есть каждый отдельный пакет рассматривается сетью как совершенно независимая единица передачи — **дейтаграмма**.

Решение о продвижении пакета принимается на основе таблицы коммутации, ставящей в соответствие адресам назначения пакетов информацию, однозначно определяющую следующий по маршруту транзитный (или конечный) узел. В качестве такой информации могут выступать идентификаторы интерфейсов данного коммутатора или адреса входных интерфейсов коммутаторов, следующих по маршруту.

В таблице коммутации для одного и того же адреса назначения может содержаться несколько записей, указывающих соответственно на различные адреса следующего коммутатора. Такой подход называется **балансом нагрузки** и используется для повышения производительности и надежности сети.

Некоторая «размытость» путей следования пакетов с одним и тем же адресом назначения через сеть является прямым следствием принципа независимой обработки каждого пакета, присущего дейтаграммному методу.

В дейтаграммном методе доставка пакета не гарантируется, а выполняется по мере возможности — для описания такого свойства используется термин **доставка по возможности (best effort)**.

### Передача с установлением логического соединения
Следующий рассматриваемый нами способ продвижения пакетов основывается на знании устройствами сети «истории» обмена данными, например, на запоминании узлом-отправителем числа отправленных, а узлом-получателем — числа полученных пакетов. Такого рода информация фиксируется в рамках логического соединения.

Процедура согласования двумя конечными узлами сети некоторых параметров процесса обмена пакетами называется **установлением логического соединения.** Параметры, о которых договариваются два взаимодействующих узла, называются **параметрами логического соединения**.

Наличие логического соединения позволяет более рационально по сравнению с дейтаграммным способом обрабатывать пакеты. Например, при потере нескольких предыдущих пакетов может быть снижена скорость отправки последующих. Напротив, благодаря нумерации пакетов и отслеживанию номеров отправленных и принятых пакетов можно повысить надежность путем отбрасывания дубликатов, упорядочивания поступивших и повторения передачи потерянных пакетов.

Передача с установлением логического соединения включает три фазы:
1. Установление логического соединения, которое начинается с того, что узел — инициатор соединения отправляет узлу-получателю служебный пакет с предложением установить соединение. Если узел-получатель согласен с этим, то он посылает в ответ другой служебный пакет, подтверждающий установление соединения и предлагающий некоторые параметры, которые должны использоваться в рамках данного логического соединения.
Узел — инициатор соединения может закончить процесс установления соединения отправкой третьего служебного пакета, в котором сообщит, что предложенные параметры ему подходят.
2. Передача данных. После того как соединение установлено и все параметры согласованы, конечные узлы начинают передачу собственно данных. Логическое соединение может быть рассчитано на передачу данных как в одном направлении (от инициатора соединения), так и в обоих направлениях.
3. Разрыв логического соединения. После передачи некоторого законченного набора данных, например определенного файла, узел-отправитель инициирует процедуру разрыва логического соединения, аналогичную процедуре установления соединения.

В отличие от передачи дейтаграммного типа, в которой поддерживается только один тип пакетов — информационный, передача с установлением соединения должна поддерживать как минимум два типа пакетов — **информационные пакеты** переносят собственно пользовательские данные, а **служебные** предназначаются для установления (разрыва) соединения.

Передача с установлением соединения имеет важное отличие от дейтаграммной передачи, поскольку в ней, помимо обработки пакетов на коммутаторах, имеет место **дополнительная обработка пакетов на конечных узлах**.
Например, если при установлении соединения была оговорена передача данных в зашифрованном виде, то шифрование пакетов выполняется узлом-отправителем, а дешифрование — узлом-получателем.
Аналогично, для обеспечения в рамках логического соединения надежности всю работу по нумерации пакетов, отслеживанию номеров доставленных и недоставленных пакетов, посылке копий и отбрасыванию дубликатов берут на себя конечные узлы.

Передача с установлением соединения предоставляет больше возможностей в плане надежности и безопасности обмена данными, чем дейтаграммная передача. Однако этот способ более медленный, так как он подразумевает дополнительные вычислительные затраты на установление и поддержание логического соединения.

### Передача с установлением виртуального канала
Следующий способ продвижения данных в пакетных сетях основан на частном случае логического соединения, в число параметров которого входит жестко определенный для всех пакетов маршрут. То есть все пакеты, передаваемые в рамках данного соединения, должны проходить строго по одному и тому же закрепленному за этим соединением пути.

Единственный заранее проложенный фиксированный маршрут, соединяющий конечные узлы в сети с коммутацией пакетов, называют **виртуальным каналом (virtual circuit, или virtual channel)**.

Виртуальные каналы прокладываются для **устойчивых** информационных потоков. С целью выделения потока данных из общего трафика каждый пакет этого потока помечается признаком особого вида — меткой.

После прокладки виртуального канала сеть может передавать по нему соответствующий поток данных. Во всех пакетах, которые переносят пользовательские данные, адрес назначения уже не указывается, его роль играет метка виртуального канала. При поступлении пакета на входной интерфейс коммутатор читает значение метки из заголовка пришедшего пакета и просматривает свою таблицу коммутации, по которой определяет, на какой выходной порт передать пришедший пакет.

Таблица коммутации в сетях, использующих виртуальные каналы, отличается от таблицы коммутации в дейтаграммных сетях. Она содержит записи *только о проходящих через коммутатор виртуальных каналах*, а не обо всех возможных адресах назначения, как это имеет место в сетях с дейтаграммным алгоритмом продвижения.
Обычно в крупной сети количество проложенных через узел виртуальных каналов существенно меньше общего количества узлов, поэтому таблицы коммутации в этом случае намного короче и, следовательно, анализ такой таблицы занимает у коммутатора меньше времени. По той же причине метка короче адреса конечного узла, и заголовок пакета в сетях с виртуальными каналами переносит по сети вместо длинного адреса компактный идентификатор потока.

В одной и той же сетевой технологии могут быть задействованы разные способы продвижения данных. Так, для передачи данных между отдельными сетями, составляющими Интернет, используется дейтаграммный протокол IP. В то же время обеспечением надежной доставки данных между конечными узлами этой сети занимается протокол TCP, устанавливающий логические соединения без фиксации маршрута. И наконец, Интернет — это пример сети, применяющей технику виртуальных каналов, так как в состав Интернета входит немало сетей MPLS, поддерживающих виртуальные каналы.

## Сравнение сетей с коммутацией пакетов и каналов
### Структура задержек в сетях с коммутацией каналов и пакетов
*В сети с коммутацией каналов* данные после задержки, связанной с установлением канала, начинают передаваться на стандартной для канала скорости. Время доставки данных адресату (Т) равно сумме времени распространения сигнала в канале t prg (prg — propagation) и времени передачи сообщения в канал t trns (trns — transmission), называемого также временем сериализации.
Наличие коммутаторов в сети с коммутацией каналов никак не влияет на суммарное время прохождения данных через сеть.

Время распространения сигнала зависит от расстояния между абонентами L и скорости S распространения электромагнитных волн в конкретной физической среде, которая колеблется от 0,6 до 0,9 скорости света в вакууме

Время сериализации (а значит, и время буферизации в узле назначения) равно отношению объема сообщения V в битах к пропускной способности канала C в битах в секунду

**В сети с коммутацией пакетов** передача данных не требует обязательного установления соединения.
Однако разбиение передаваемого сообщения на пакеты с последующей их передачей по сети с коммутацией пакетов приводит к дополнительным задержкам.

Во-первых, время тратится в узле-отправителе N1:
* t 1 — время формирования пакета, также называемое временем пакетизации (зависит от различных параметров работы программного и аппаратного обеспечения узла отправителя и не зависит от параметров сети);
* t 2 — время передачи в канал заголовка;
* t 3 — время передачи в канал поля данных пакета;
* t 4 — дополнительное время тратится на распространение сигналов по каналам связи между узлом-отправителем и коммутатором (коммутатором и коммутатором).
Дополнительное время тратится в промежуточном коммутаторе:
* t 5 — время приема пакета с его заголовком из канала во входной буфер коммутатора; как отмечено, это время равно (t 2 + t 3 ), то есть времени передачи пакета с заголовком в канал из узла источника;
* t 6 — время ожидания пакета в очереди, колеблется в очень широких пределах и заранее не известно, так как зависит от текущей загрузки сети;
* t 7 — время коммутации пакета при его передаче в выходной порт, фиксировано для конкретной модели и обычно невелико (от нескольких микросекунд до нескольких миллисекунд)

# Chapter 4. Стандартизация и классификация сетей
## Декомпозиция задачи сетевого взаимодействия
**Сетевая архитектура** — это концептуальная схема функционирования компьютерной сети, определяющая принципы работы аппаратных и программных сетевых компонентов, организацию их связей, протоколы взаимодействия и способы физической передачи данных. Архитектура сети отражает декомпозицию общей задачи взаимодействия компьютеров на отдельные *подзадачи, которые должны решаться отдельными компонентами сети* — конечными узлами (компьютерами) и промежуточными узлами (коммутаторами и маршрутизаторами).

### Многоуровневый подход
**Межуровневый интерфейс**, называемый также **интерфейсом услуг**, определяет набор функций, которые нижележащий уровень предоставляет вышележащему.

### Протокол и стек протоколов
В процессе обмена сообщениями участвуют, по меньшей мере, две стороны, то есть в данном случае необходимо организовать согласованную работу двух иерархий аппаратных и программных средств на разных компьютерах.

Модель взаимодействия двух узлов.
Это *одноранговый интерфейс* со средствами взаимодействия другой стороны, расположенными на том же уровне иерархии. Этот тип интерфейса называют **протоколом**.

В сущности, термины «протокол» и «интерфейс» обозначают одно и то же — формализованное описание процедуры взаимодействия двух объектов, но традиционно в сетях за ними закрепили разные области предпочтительного использования: протоколы определяют правила взаимодействия модулей одного уровня (одного ранга) в разных узлах, а интерфейсы — правила взаимодействия модулей соседних уровней в одном узле.

Иерархически организованный набор протоколов, достаточный для организации взаимодействия узлов в сети, называется **стеком протоколов**.

Протоколы нижних уровней часто реализуются комбинацией программных и аппаратных средств, а протоколы верхних уровней, как правило — программными средствами. Программный модуль, реализующий некоторый протокол, называют **протокольной сущностью**, или, для краткости, тоже протоколом.

Протокольные сущности одного уровня обмениваются сообщениями в соответствии с определенным для них протоколом. Сообщения состоят из заголовка и поля данных (иногда оно может отсутствовать). Обмен сообщениями является своеобразным языком общения, с помощью которого каждая из сторон «объясняет» другой стороне, что необходимо сделать на каждом этапе взаимодействия. Работа каждого протокольного модуля состоит в интерпретации заголовков поступающих к нему сообщений и выполнении связанных с этим действий.

## Модель OSI
В начале 80-х годов ряд международных организаций по стандартизации, в частности International Organization for Standartization, часто называемая International Standards Organization (ISO), а также International Telecommunications Union (ITU) и некоторые другие разработали стандартную модель взаимодействия открытых систем **(Open System Interconnection, OSI)**.

### Общая характеристика модели OSI
**Модель OSI** имеет дело со стеком протоколов для сетей с коммутацией пакетов. Модель OSI не содержит описаний реализаций конкретного набора протоколов. Она лишь определяет, во-первых, уровни взаимодействия, во-вторых, стандартные названия уровней, в-третьих, функции, которые должен выполнять каждый уровень.
В модели OSI средства взаимодействия делятся на семь уровней:
* прикладной (application layer);
* представления (presentation layer);
* сеансовый (session layer);
* транспортный (transport layer);
* сетевой (network layer);
* канальный (data link layer);
* физический (physical layer).

Приложения могут реализовывать собственные протоколы взаимодействия, используя для этих целей многоуровневую совокупность системных средств. Именно для этого в распоряжение программистов предоставляется прикладной программный интерфейс **(Application Program Interface, API)**. В соответствии с моделью OSI приложение может обращаться с запросами только к самому верхнему уровню — прикладному, однако на практике многие стеки коммуникационных протоколов предоставляют возможность программистам напрямую обращаться к сервисам или службам нижележащих уровней.

В стандартах ISO для обозначения единиц обмена данными, с которыми имеют дело протоколы разных уровней, используется общее название протокольная единица данных (Protocol Data Unit, PDU). Для обозначения единиц обмена данными конкретных уровней часто используются специальные названия, в частности: сообщение, кадр, пакет, дейтаграмма, сегмент.

Протоколы нижних четырех уровней обобщенно называют сетевым транспортом, или транспортной подсистемой, так как они полностью решают задачу транспортировки сообщений с заданным уровнем качества в составных сетях с произвольной топологией и различными технологиями. Оставшиеся три верхних уровня объединяет то, что они тесно связаны с пользовательскими приложениями, предоставляя им высокоуровневые услуги по использованию сетевых ресурсов и сервисов.

### Физический уровень
**Физический уровень** модели OSI имеет дело с передачей потока битов по физическим каналам связи, таким как коаксиальный кабель, витая пара, оптоволоконный кабель или беспроводная линия связи.

Функции физического уровня реализуются на всех устройствах, подключенных к сети.  Со стороны компьютера эти функции выполняются сетевым адаптером, со стороны промежуточных сетевых устройств — коммутаторов, маршрутизаторов, мультиплексоров и др. — входными и выходными интерфейсами (портами).

Физический уровень не вникает в смысл информации, которую он передает. Для него информация, поступающая от вышележащего канального уровня, представляет собой однородный поток битов, которые нужно доставить без искажений, в соответствии с заданной тактовой частотой (интервалом между соседними битами) и выбранным способом кодирования.

### Канальный уровень
**Канальный уровень**, используя возможности, предоставляемые ему нижележащим, физическим, уровнем, предлагает вышележащему, сетевому, уровню следующие услуги:
* установление логического соединения между взаимодействующими узлами;
* согласование в рамках соединения скоростей передатчика и приемника информации;
* обеспечение надежной передачи, обнаружение и коррекцию ошибок.
В сетях, построенных на основе разделяемой среды, физический уровень выполняет еще одну функцию — проверяет доступность разделяемой среды. Эту функцию иногда выделяют в отдельный подуровень управления доступом к среде **(Medium Access Control, MAC)**.

Протокол канального уровня обычно работает в пределах сети, являющейся одной из частей более крупной составной сети, объединенной протоколами сетевого уровня. Адреса, с которыми работает протокол канального уровня, используются для доставки кадров только в пределах этой сети, а для перемещения пакетов между сетями применяются адреса уже следующего, сетевого уровня.

Протокольной единицей данных канального уровня является **кадр**. В поле данных кадра размещается сообщение сетевого уровня, а в заголовке — служебная информация, включающая адрес назначения, на основании которого коммутаторы сети будут продвигать пакет.
Одной из задач канального уровня является **обнаружение и коррекция ошибок**. Канальный уровень может обеспечить надежность передачи, например, путем фиксирования границ кадра, помещая специальную последовательность битов в его начало и конец, а затем добавляя к кадру контрольную сумму.

Прежде чем переправить кадр физическому уровню для непосредственной передачи данных в сеть, подуровень MAC канального уровня должен **проверить доступность среды**.
Если разделяемая среда освободилась (когда она не используется, такая проверка пропускается), то кадр передается средствами физического уровня в сеть.

### Сетевой уровень
**Сетевой уровень** служит для образования единой транспортной системы, объединяющей несколько сетей и называемой **составной сетью**, или **интернетом** (с маленькой буквы).
Технология, позволяющая соединять в единую сеть множество сетей, в общем случае построенных на основе разных технологий, называется технологией **межсетевого взаимодействия** (internetworking).

Чтобы связать между собой сети, построенные на основе отличающихся технологий (Ethernet, FDDI, ATM, Frame Relay, etc.), нужны дополнительные средства, предоставляемые сетевым уровнем.
Функции сетевого уровня реализуются:
* группой протоколов;
* специальными устройствами — маршрутизаторами.

Одной из функций маршрутизатора является **физическое соединение сетей**. Маршрутизатор имеет несколько сетевых интерфейсов, подобных интерфейсам компьютера, к каждому из которых может быть подключена одна сеть. Таким образом, интерфейсы маршрутизатора можно считать узлами разных сетей. Маршрутизатор может быть реализован программно на базе универсального компьютера (например, типовая конфигурация Unix или Windows включает программный модуль маршрутизатора). Однако чаще маршрутизаторы реализуются на базе специализированных аппаратных платформ. В состав программного обеспечения маршрутизатора входят протокольные модули сетевого уровня.

Чтобы связать сети, необходимо соединить их маршрутизаторами и установить протокольные модули сетевого уровня на все конечные узлы пользователей, которые хотели бы связываться через составную сеть.

Данные, которые необходимо передать через составную сеть, поступают на сетевой уровень от вышележащего транспортного уровня. Эти данные снабжаются заголовком сетевого уровня. Данные вместе с заголовком образуют **пакет** — так называется протокольная единица данных сетевого уровня.
Заголовок пакета сетевого уровня наряду с другой служебной информацией несет данные об адресе назначения этого пакета. Чтобы протоколы сетевого уровня могли доставлять пакеты любому узлу составной сети, эти узлы должны иметь *адреса, уникальные в пределах всей составной сети*. Такие адреса называются **сетевыми** или **глобальными**. Каждый узел составной сети, который намерен обмениваться данными с другими узлами составной сети, наряду с адресом, назначенным ему на канальном уровне, должен иметь сетевой адрес.

**Определение маршрута** является важной задачей сетевого уровня. Маршрут описывается последовательностью сетей (или маршрутизаторов), через которые должен пройти пакет, чтобы попасть к адресату.

Маршрутизатор собирает информацию о топологии связей между сетями и на основе этой информации строит таблицы коммутации, которые в данном случае носят специальное название **таблиц маршрутизации**.

Чтобы передать пакет через очередную сеть, сетевой уровень помещает его в поле данных кадра соответствующей канальной технологии. В заголовке кадра указывается **адрес канального уровня** интерфейса следующего маршрутизатора. Сеть, используя свою канальную технологию, доставляет кадр с инкапсулированным в него пакетом по заданному адресу.
Маршрутизатор извлекает пакет из прибывшего кадра и после необходимой обработки передает пакет для дальнейшей транспортировки в следующую сеть, предварительно упаковав его в новый кадр канального уровня в общем случае другой технологии. Таким образом, сетевой уровень играет роль **координатора**, организующего совместную работу сетей, построенных на основе разных технологий.

В заключение отметим, что на сетевом уровне определяются два вида протоколов.
1. **Маршрутизируемые протоколы** — реализует продвижение пакетов через сеть.
Именно эти протоколы обычно имеют в виду, когда говорят о протоколах сетевого уровня.
2. **Маршрутизирующие протоколы**, или протоколы маршрутизации. С помощью этих протоколов маршрутизаторы собирают информацию о топологии межсетевых соединений, на основании которой осуществляется выбор маршрута продвижения пакетов.

### Транспортный уровень
**Транспортный уровень** обеспечивает приложениям и верхним уровням стека — прикладному, представления и сеансовому — передачу данных с той степенью надежности, которая им требуется.

Все протоколы, начиная с транспортного уровня и выше, реализуются программными средствами конечных узлов сети — компонентами их сетевых операционных систем. В качестве примера транспортных протоколов можно привести протоколы TCP и UDP стека TCP/IP и протокол SPX стека Novell.

### Сеансовый уровень
**Сеансовый уровень** управляет взаимодействием сторон: фиксирует, какая из сторон является активной в настоящий момент, и предоставляет средства синхронизации сеанса.
Эти средства позволяют в ходе длинных передач сохранять информацию о состоянии этих передач в виде контрольных точек, чтобы в случае отказа можно было вернуться назад к последней контрольной точке, а не начинать все с начала. На практике немногие приложения используют сеансовый уровень, который редко реализуется в виде отдельных протоколов. Функции этого уровня часто объединяют с функциями прикладного уровня и реализуют в одном протоколе.

### Уровень представления
**Уровень представления**, как явствует из его названия, обеспечивает представление передаваемой по сети информации, не меняя при этом ее содержания. За счет уровня представления информация, передаваемая прикладным уровнем одной системы, всегда понятна прикладному уровню другой системы. С помощью средств данного уровня протоколы прикладных уровней могут преодолеть синтаксические различия в представлении данных или же различия в кодах символов, например кодов ASCII и EBCDIC. На этом уровне могут выполняться шифрование и дешифрование данных, благодаря которым секретность обмена данными обеспечивается сразу для всех прикладных служб. Примером такого протокола является протокол SSL (Secure Socket Layer), который обеспечивает секретный обмен сообщениями для протоколов прикладного уровня стека TCP/IP.
Для повышения эффективности обмена текстами и графическими изображениями уровень представления может оказывать услуги по сжатию/распаковке информации.
К функциям уровня представления относится также кодирование графических изображений

### Прикладной уровень
В качестве функций прикладного уровня модель OSI определяет предоставление разнообразных услуг пользовательским приложениям — таких, как доступ к общим сетевым ресурсам (файлам, принтерам или веб-страницам) или распределенным сетевым сервисам (электронной почте, службам передачи сообщений, базам данных). Как правило, услуги прикладного уровня включают идентификацию и аутентификацию участников сетевого взаимодействия, проверку их доступности и полномочий, определение требований к защищенности сеанса обмена и т. д.

P. S. Для сетей с коммутацией пакетов сети с коммутацией каналов предоставляют сервис физического уровня, хотя сами они устроены достаточно сложно и поддерживают собственную иерархию протоколов.


