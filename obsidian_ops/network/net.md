# History

С одной стороны, компьютерные сети представляют собой группу компьютеров, согласованно решающих набор взаимосвязанных задач, обмениваясь данными в автоматическом режиме.
С другой стороны, компьютерные сети могут рассматриваться как средство передачи информации на большие расстояния, для чего в них применяются методы кодирования и мультиплексирования данных, получившие развитие в различных телекоммуникационных системах, например телефонных сетях.

Многотерминальные системы, работающие в режиме разделения времени, стали прообразом локальных вычислительных сетей.

Затем появились системы, в которых наряду с удаленными соединениями типа терминал — компьютер были реализованы и удаленные связи типа компьютер — компьютер.
Разнесенные территориально компьютеры получили возможность обмениваться данными в автоматическом режиме, что, собственно, и является базовым признаком любой вычислительной сети.

Хронологически первыми появились глобальные сети (Wide Area Network, WAN), то есть сети, объединяющие территориально рассредоточенные компьютеры, возможно, находящиеся в различных городах и странах.

Сеть ARPANET объединяла компьютеры разных типов, работавшие под управлением различных операционных систем (ОС) с дополнительными модулями, реализующими коммуникационные протоколы, общие для всех компьютеров сети. ОС этих компьютеров можно считать первыми сетевыми операционными системами.

Любая сетевая операционная система, с одной стороны, выполняет все функции локальной операционной системы, а с другой стороны, обладает некоторыми дополнительными средствами, позволяющими ей взаимодействовать через сеть с операционными системами других компьютеров. 

В результате технологического прорыва в области производства компьютерных компонентов появились большие интегральные схемы (БИС). Их сравнительно невысокая стоимость и хорошие функциональные возможности привели к созданию мини-компьютеров.
Даже небольшие подразделения предприятий получили возможность иметь собственные компьютеры. Мини-компьютеры решали задачи управления технологическим оборудованием, складом и другие задачи уровня отдела предприятия. Таким образом, появилась концепция распределения компьютерных ресурсов по всему предприятию. 

# Termins

**Локальные сети** (Local Area Network, LAN) — это объединения компьютеров, сосредоточенных на небольшой территории, обычно в радиусе не более 1–2 км, хотя в отдельных случаях локальная сеть может иметь и большие размеры, например, несколько десятков километров Обычно локальная сеть представляет собой коммуникационную систему, принадлежащую одной организации.

**Сетевая технология** — это согласованный набор программных и аппаратных средств (например, драйверов, сетевых адаптеров, кабелей и разъемов), а также механизмов передачи данных по линиям связи, достаточный для построения вычислительной сети.

Исторически главной целью объединения компьютеров в сеть было разделение ресурсов.
Для связи устройств в них прежде всего должны быть предусмотрены внешние интерфейсы.
**Интерфейс** — в широком смысле — формально определенная логическая и/или физическая граница между отдельными объектами, которые обмениваются информацией. Интерфейс задает параметры, процедуры и характеристики взаимодействия объектов.

**Физический интерфейс** (называемый также портом) определяется набором электрических связей и характеристиками сигналов. Обычно он представляет собой разъем с набором контактов, каждый из которых имеет определенное назначение, например, это может быть группа контактов для передачи данных, контакт синхронизации данных и т. п.
Пара разъемов соединяется кабелем, состоящим из набора проводов, каждый из которых соединяет соответствующие контакты. В таких случаях говорят о создании линии, или канала, связи между двумя устройствами.
**Логический интерфейс** (называемый также протоколом) — это набор информационных сообщений определенного формата, которыми обмениваются два устройства или две программы, а также набор правил, определяющих логику обмена этими сообщениями.

Интерфейс компьютер — компьютер позволяет двум компьютерам обмениваться информацией. С каждой стороны он реализуется парой:
* **аппаратным модулем**, называемым сетевым адаптером или **сетевой интерфейсной картой (ИК)**, или (в англоязычном варианте) Network Interface Card, NIC;
* **драйвером сетевой интерфейсной карты** — специальной программой, управляющей работой сетевой интерфейсной карты.

**Клиент** — это модуль, предназначенный для формирования и передачи сообщений-запросов к ресурсам удаленного компьютера от разных приложений с последующим приемом результатов из сети и передачей их соответствующим приложениям.
**Сервер** — это модуль, который постоянно ожидает прихода из сети запросов от клиентов и, приняв запрос, пытается его обслужить, как правило, с участием локальной ОС; один сервер может обслуживать запросы сразу нескольких клиентов (поочередно или одновременно).
**Пара клиент-сервер**, предоставляющая доступ к конкретному типу ресурса компьютера через сеть, образует **сетевую службу**.

Каждая служба связана с определенным типом сетевых ресурсов.

Услуги, предоставляемые службой, называются **сервисом**.

Пример: сервисы аудита, аутентификации, авторизации и др.

**Web as example**
Для поиска и просмотра информации в Интернете используется веб-служба, состоящая из веб-сервера и клиентской программы, называемой веб-браузером (web browser). Разделяемым ресурсом в данном случае является веб-сайт — определенным образом организованный набор файлов, содержащих связанную в смысловом отношении информацию и хранящихся на внешнем накопителе веб-сервера.

Усложнение среды передачи сообщений приводит к возникновению новых дополнительных задач, на решение которых не был рассчитан упоминавшийся ранее простейший драйвер сетевой интерфейсной карты. Вместо него на взаимодействующих компьютерах должны быть установлены более развитые программные транспортные средства.

Операционную систему компьютера часто определяют как взаимосвязанный набор системных программ, который обеспечивает эффективное управление ресурсами компьютера (памятью, процессором, внешними устройствами, файлами и др.), а также предоставляет пользователю удобный интерфейс для работы с аппаратурой компьютера и разработки приложений.
Говоря о сетевой ОС, мы, очевидно, должны расширить границы управляемых ресурсов за пределы одного компьютера.
Сетевой операционной системой называют операционную систему компьютера, которая, помимо управления локальными ресурсами, предоставляет пользователям и приложениям возможность эффективного и удобного доступа к информационным и аппаратным ресурсам других компьютеров сети.

Помимо сетевых служб сетевая ОС включает программные коммуникационные (транспортные) средства, обеспечивающие совместно с аппаратными коммуникационными средствами передачу сообщений, которыми обмениваются клиентские и серверные части сетевых служб.
Задачу коммуникации между компьютерами сети решают драйверы и протокольные модули.
Они выполняют такие функции, как формирование сообщений, разбиение сообщения на части (пакеты, кадры), преобразование имен компьютеров в числовые адреса, дублирование сообщений в случае их потери, определение маршрута в сложной сети и т. д.

Сетевая служба может быть представлена в ОС либо обеими (клиентской и серверной) частями, либо только одной из них.

В первом случае операционная система, называемая **одноранговой**, не только позволяет обращаться к ресурсам других компьютеров, но и предоставляет собственные ресурсы в распоряжение пользователей других компьютеров. Например, если на всех компьютерах сети установлены и клиенты, и серверы файловой службы, то все пользователи сети могут совместно использовать файлы друг друга. Компьютеры, совмещающие функции клиента и сервера, называют одноранговыми узлами.

Операционная система, которая содержит преимущественно клиентские части сетевых служб, называется **клиентской**. Клиентские ОС устанавливаются на компьютеры, обращающиеся с запросами к ресурсам других компьютеров сети. За такими компьютерами, также называемыми клиентскими, работают рядовые пользователи. Обычно клиентские компьютеры относятся к классу относительно простых устройств.

К другому типу операционных систем относится **серверная** ОС — она ориентирована на обработку запросов из сети к ресурсам своего компьютера и включает в себя в основном серверные части сетевых служб. Компьютер с установленной на нем серверной ОС, занимающийся исключительно обслуживанием запросов других компьютеров, называют выделенным сервером сети.

На компьютере, подключенном к сети, могут запускаться приложения нескольких типов:
* **Локальное приложение** целиком выполняется на данном компьютере и использует только локальные ресурсы.
* **Централизованное сетевое приложение** целиком выполняется на данном компьютере, но обращается в процессе своей работы к ресурсам других компьютеров сети.
* **Распределенное (сетевое) приложение** состоит из нескольких взаимодействующих частей, каждая из которых выполняет какую-то определенную законченную работу по решению прикладной задачи, причем каждая часть может выполняться и, как правило, выполняется на отдельном компьютере сети.

# Характеристики физических каналов

* **Предложенная нагрузка** — это поток данных, поступающий от приложения пользователя на вход сети, которая всегда готова принять данные. Предложенную нагрузку можно характеризовать скоростью генерации данных в битах в секунду.
* **Пропускная способность**, называемая также емкостью канала связи (capacity), представляет собой максимально возможную скорость передачи информации по данному каналу.
* **Скорость передачи данных** (information rate, или throughput, оба английских термина используются равноправно) — это фактическая скорость потока данных, прошедшего через сеть или некоторые ее фрагменты.
Скорость информационного потока, называемая также скоростью передачи данных, определяется как частное от деления объема данных, переданных за некоторый интервал времени, на величину этого интервала.
Из определения следует, что эта характеристика всегда является усредненной. Она отражает как скорость поступления данных в сеть — предложенную нагрузку, так и скоростные свойства физических каналов — пропускную способность сети. Скорость передачи данных может быть ниже предложенной нагрузки, так как данные в сети могут искажаться или теряться, или на некоторых участках выше — когда предварительно буферизованные данные передаются скоростным каналом.

**Типы физических каналов связи:**
* **Дуплексный канал** обеспечивает одновременную передачу информации в обоих направлениях. Дуплексный канал может состоять из двух физических сред, каждая из которых используется для передачи информации только в одном направлении.  Возможен вариант, когда одна среда служит для одновременной передачи встречных потоков. При этом применяют дополнительные методы выделения каждого потока из суммарного сигнала.
* **Полудуплексный канал** также обеспечивает передачу информации в обоих направлениях, но не одновременно, а по очереди. То есть в течение определенного периода времени информация передается в одном направлении, а в течение следующего периода — в обратном.
* **Симплексный канал** позволяет передавать информацию только в одном направлении. Часто дуплексный канал состоит из двух симплексных каналов.

Под **топологией сети** понимается конфигурация графа, вершинам которого соответствуют конечные узлы сети (например, компьютеры) и коммуникационное оборудование (например, маршрутизаторы), а ребрам — физические или информационные связи между вершинами.

Рассматривают следующие топологии:
* Полносвязная,
* Ячеистая,
* Кольцевая,
* Звездообразная,
* Иерархическая звезда (дерево),
* Общая шина (частный случай),
* Смешанная топология.

Адресация узлов сети (адресация сетевых интерфейсов).
* Unicast,
* Multicast,
* Broadcast,
* Anycast.

Множество всех адресов, которые являются допустимыми в рамках некоторой схемы адресации, называется **адресным пространством**. Адресное пространство может иметь плоскую (линейную) или иерархическую организацию.

При **централизованном подходе** в сети выделяется один или несколько компьютеров (серверов имен), в которых хранится таблица соответствия имен различных типов — например, символьных имен и числовых адресов. Все остальные компьютеры обращаются к серверу имен с запросами, чтобы по символьному имени найти числовой номер необходимого компьютера.
При **распределенном подходе** каждый компьютер сам хранит все назначенные ему адреса разного типа. Тогда компьютер, которому необходимо определить по известному иерархическому числовому адресу некоторого компьютера его плоский аппаратный адрес, посылает в сеть широковещательный запрос. Все компьютеры сети сравнивают содержащийся в запросе адрес с собственным. Тот компьютер, у которого обнаружилось совпадение, посылает ответ, содержащий искомый аппаратный адрес. Такая схема использована в протоколе разрешения адресов (Address Resolution Protocol, ARP) стека TCP/IP.

Достоинство распределенного подхода состоит в том, что он позволяет отказаться от выделения специального компьютера в качестве сервера имен, который к тому же часто требует ручного задания таблицы соответствия адресов. Недостатком его является необходимость широковещательных сообщений, перегружающих сеть. Именно поэтому распределенный подход используется в небольших сетях, а централизованный — в больших.

# Commutation

Соединение конечных узлов через сеть транзитных узлов называют коммутацией. Последовательность узлов, лежащих на пути от отправителя к получателю, образует маршрут.

В самом общем виде задача коммутации может быть представлена в виде следующих взаимосвязанных частных задач:
1. Определение информационных потоков, для которых требуется прокладывать маршруты.
2. Маршрутизация потоков — прокладка маршрутов.
3. Продвижение потоков, то есть распознавание потоков и их локальная коммутация на каждом транзитном узле.
4. Мультиплексирование и демультиплексирование потоков.

## Определение информационных потоков
**Информационным потоком**, или потоком данных, называют непрерывную последовательность данных, объединенных набором общих признаков, выделяющих эти данные из общего сетевого трафика.
Например, как поток можно определить все данные, поступающие от одного компьютера; объединяющим признаком в данном случае служит адрес источника. Эти же данные можно представить как совокупность нескольких подпотоков, каждый из которых в качестве дифференцирующего признака имеет адрес назначения.

При коммутации в качестве обязательного признака выступает адрес назначения данных.
На основании этого признака весь поток входящих в транзитный узел данных разделяется на подпотоки, каждый из которых передается на интерфейс, соответствующий тому или иному маршруту продвижения данных.

Метка потока — это особый тип признака. Она представляет собой некоторое число, которое несут все данные потока. Глобальная метка назначается данным потока и не меняет своего значения на всем протяжении его пути следования от узла источника до узла назначения, таким образом, она уникально определяет поток в пределах сети. В некоторых технологиях используются локальные метки потока, динамически меняющие свое значение при передаче данных от одного узла к другому.
Таким образом, распознавание потоков во время коммутации происходит на основании признаков, в качестве которых, помимо обязательного адреса назначения данных, могут выступать и другие признаки — такие, например, как идентификаторы приложений.

## Маршрутизация

Задача маршрутизации, в свою очередь, включает в себя две подзадачи:
* определение маршрута;
* оповещение сети о выбранном маршруте.
Определить маршрут означает выбрать последовательность транзитных узлов и их интерфейсов, через которые надо передавать данные, чтобы доставить их адресату.

Абстрактная оценка условного «расстояния» между двумя узлами сети называется **метрикой**. Так, для измерения длины маршрута могут быть использованы разные метрики — количество транзитных узлов, как в предыдущем примере, линейная протяженность маршрута и даже его стоимость в денежном выражении.

После того как маршрут определен (вручную или автоматически), надо оповестить о нем все устройства сети. Сообщение о маршруте должно нести каждому транзитному устройству примерно такую информацию: «каждый раз, когда в устройство поступят данные, относящиеся к потоку n, их следует передать для дальнейшего продвижения на интерфейс if1». Каждое подобное сообщение о маршруте обрабатывается транзитным устройством, в результате создается новая запись в **таблице коммутации** (называемой также **таблицей маршрутизации**) данного устройства. В этой таблице локальному или глобальному признаку (признакам) потока (например, метке, номеру входного интерфейса или адресу назначения) ставится в соответствие номер интерфейса, на который устройство должно передавать данные, относящиеся к этому потоку.

## Продвижение данных

Для каждой пары абонентов эта операция может быть представлена несколькими (по числу транзитных узлов) локальными операциями коммутации. Прежде всего отправитель должен выставить данные на тот свой интерфейс, с которого начинается найденный маршрут, а все транзитные узлы должны соответствующим образом выполнить «переброску» данных с одного своего интерфейса на другой, другими словами, выполнить **коммутацию интерфейсов**. Устройство, функциональным назначением которого является коммутация, называется **коммутатором**.

**Интерфейс коммутатора** (называемый также **портом**) является физическим модулем, состоящим из приемника и передатчика. В том случае, когда передатчик и приемник работают на дуплексный канал связи, они работают независимо друг от друга, обеспечивая одновременную передачу данных в обоих направлениях. Иногда приемную часть интерфейса называют **входным интерфейсом**, а выходную часть — **выходным интерфейсом**.

Коммутатором может быть как специализированное устройство, так и универсальный компьютер со встроенным программным механизмом коммутации, в этом случае коммутатор называется **программным**.

Во многих случаях более рациональным является решение, в соответствии с которым некоторые узлы в сети выделяются специально для коммутации. Эти узлы образуют **коммутационную сеть**, к которой подключаются все остальные.

**Мультиплексирование** (агрегирование) — образование из нескольких отдельных потоков общего агрегированного потока, который передается по одному физическому каналу связи.
Другими словами, мультиплексирование — это способ разделения одного имеющегося физического канала между несколькими одновременно протекающими сеансами связи абонентов сети.

**Демультиплексирование** — разделение суммарного потока на несколько составляющих его потоков.

Одним из основных способов мультиплексирования потоков является разделение времени.
Распространено также частотное разделение канала, когда каждый поток передает данные в выделенном ему частотном диапазоне.

Частный случай коммутатора, у которого все входящие информационные потоки коммутируются на один выходной интерфейс, где они мультиплексируются в один агрегированный поток, называется **мультиплексором**. Коммутатор, который имеет один входной интерфейс и несколько выходных, называется **демультиплексором**.

**Разделяемой средой** (shared medium) называется физическая среда передачи данных, к которой непосредственно подключено несколько передатчиков узлов сети. Причем в каждый момент времени только один из передатчиков какого-либо узла сети получает доступ к разделяемой среде и использует ее для передачи данных приемнику другого узла, подключенному к этой же среде.

Существуют различные способы решения задачи организации совместного доступа
к разделяемым линиям связи. Одни из них подразумевают централизованный подход, когда доступом к каналу управляет специальное устройство — **арбитр**, другие — децентрализованный. Если мы обратимся к организации работы компьютера, то увидим, что доступ к системной шине компьютера, которую совместно используют внутренние блоки компьютера, управляется централизованно — либо процессором, либо специальным арбитром шины.

# Chapter 3. Коммутация каналов и пакетов

## Коммутация каналов
Сеть с коммутацией каналов представляет собой множество коммутаторов и конечных узлов — **абонентов**, соединенных между собой **линиями (звеньями) связи**. Заметим, что в данном контексте термин **«линия связи»** используется для обозначения соединения двух соседних узлов сети.

### Элементарный канал
Одной из особенностей сетей с коммутацией каналов является использование понятия «элементарный канал».
**Элементарный канал** — это базовая техническая характеристика сети с коммутацией каналов, представляющая собой некоторое фиксированное в пределах данного типа сетей значение пропускной способности. Любая линия связи в сети с коммутацией каналов имеет пропускную способность, кратную элементарному каналу, принятому для данного типа сети.

Говоря о сетях с коммутацией каналов, мы придаем термину «канал» значение
**единицы пропускной способности**.
Особенностью сетей с коммутацией каналов является то, что **пропускная способность каждой линии связи** должна быть равна целому числу элементарных каналов.

### Составной канал
Канал, построенный путем коммутации (соединения) выделенных для информационного потока элементарных каналов, называют **составным каналом**.

Свойства составного канала:
* составной канал на всем своем протяжении состоит из одинакового количества элементарных каналов;
* составной канал имеет постоянную и фиксированную пропускную способность на всем своем протяжении;
* составной канал создается временно на период сеанса связи двух абонентов или, другими словами, только на время существования потока;
* на время сеанса связи все элементарные каналы, входящие в составной канал, поступают в исключительное пользование абонентов, для которых был создан этот составной канал;
* в течение всего сеанса связи абоненты могут посылать в сеть данные со скоростью, не превышающей пропускную способность составного канала;
* данные, поступившие в составной канал, гарантированно доставляются вызываемому абоненту без задержек, потерь и с той же скоростью (скоростью источника) вне зависимости от того, существуют ли в это время в сети другие соединения или нет;
* после окончания сеанса связи элементарные каналы, входившие в соответствующий составной канал, объявляются свободными и возвращаются в пул распределяемых ресурсов для использования другими абонентами.

Таким образом, продвижение данных в сетях с коммутацией каналов происходит в два этапа:
1. В сеть поступает служебное сообщение — запрос, который несет адрес вызываемого абонента и инициирует создание составного канала.
2. По подготовленному составному каналу передается основной поток данных, для передачи которого уже не требуется никакой вспомогательной информации, в том числе адреса вызываемого абонента. Коммутация данных в коммутаторах выполняется на основе локальных признаков потока — номеров выделенных ему элементарных каналов.

## Коммутация пакетов
Важнейшим принципом функционирования сетей с коммутацией пакетов является представление информации, передаваемой по сети, в виде структурно отделенных друг от друга порций данных, называемых **пакетами**.

Каждый пакет снабжен **заголовком**, в котором содержится адрес назначения и другая вспомогательная информация (длина поля данных, контрольная сумма и др.), используемая для доставки пакета адресату. Наличие адреса в каждом пакете является одной из важнейших особенностей техники коммутации пакетов, так как каждый пакет может быть обработан коммутатором независимо от других пакетов, составляющих сетевой трафик. Помимо заголовка у пакета может иметься еще одно дополнительное поле, размещаемое в конце пакета и поэтому называемое **концевиком**. В концевике обычно помещается **контрольная сумма**, которая позволяет проверить, была ли искажена информация при передаче через сеть или нет.

### Буферизация пакетов
Главное отличие пакетных коммутаторов от коммутаторов в сетях с коммутацией каналов состоит в том, что они имеют внутреннюю **буферную память** для временного хранения пакетов.

Каждый пакет последовательно, бит за битом, помещается во **входной буфер**. Имея в виду это свойство, говорят, что сети с коммутацией пакетов используют **технику сохранения с продвижением** (store-and-forward).
Коммутатору нужны буферы, в частности, **для согласования скоростей передачи данных в линиях связи**, подключенных к его интерфейсам.

Буферизация необходима пакетному коммутатору и **для согласования скорости поступления пакетов со скоростью их коммутации**. Если коммутирующий блок не успевает обрабатывать пакеты (анализировать заголовки и перебрасывать пакеты на нужный интерфейс), то на интерфейсах коммутатора возникают **входные очереди**.

Поскольку объем буферов в коммутаторах ограничен, иногда происходит **потеря пакетов** из-за переполнения буферов при временной перегрузке части сети, когда, например, совпадают периоды пульсации нескольких информационных потоков.

Пакетный коммутатор может работать на основании одного из **трех методов продвижения пакетов**:
* дейтаграммная передача;
* передача с установлением логического соединения;
* передача с установлением виртуального канала.

### Дейтаграммная передача
**Дейтаграммный способ передачи данных** основан на том, что все передаваемые пакеты продвигаются (передаются от одного узла сети другому) независимо друг от друга на основании одних и тех же правил. Никакая информация об уже переданных пакетах сетью не хранится и в ходе обработки очередного пакета во внимание не принимается. То есть каждый отдельный пакет рассматривается сетью как совершенно независимая единица передачи — **дейтаграмма**.

Решение о продвижении пакета принимается на основе таблицы коммутации, ставящей в соответствие адресам назначения пакетов информацию, однозначно определяющую следующий по маршруту транзитный (или конечный) узел. В качестве такой информации могут выступать идентификаторы интерфейсов данного коммутатора или адреса входных интерфейсов коммутаторов, следующих по маршруту.

В таблице коммутации для одного и того же адреса назначения может содержаться несколько записей, указывающих соответственно на различные адреса следующего коммутатора. Такой подход называется **балансом нагрузки** и используется для повышения производительности и надежности сети.

Некоторая «размытость» путей следования пакетов с одним и тем же адресом назначения через сеть является прямым следствием принципа независимой обработки каждого пакета, присущего дейтаграммному методу.

В дейтаграммном методе доставка пакета не гарантируется, а выполняется по мере возможности — для описания такого свойства используется термин **доставка по возможности (best effort)**.

### Передача с установлением логического соединения
Следующий рассматриваемый нами способ продвижения пакетов основывается на знании устройствами сети «истории» обмена данными, например, на запоминании узлом-отправителем числа отправленных, а узлом-получателем — числа полученных пакетов. Такого рода информация фиксируется в рамках логического соединения.

Процедура согласования двумя конечными узлами сети некоторых параметров процесса обмена пакетами называется **установлением логического соединения.** Параметры, о которых договариваются два взаимодействующих узла, называются **параметрами логического соединения**.

Наличие логического соединения позволяет более рационально по сравнению с дейтаграммным способом обрабатывать пакеты. Например, при потере нескольких предыдущих пакетов может быть снижена скорость отправки последующих. Напротив, благодаря нумерации пакетов и отслеживанию номеров отправленных и принятых пакетов можно повысить надежность путем отбрасывания дубликатов, упорядочивания поступивших и повторения передачи потерянных пакетов.

Передача с установлением логического соединения включает три фазы:
1. Установление логического соединения, которое начинается с того, что узел — инициатор соединения отправляет узлу-получателю служебный пакет с предложением установить соединение. Если узел-получатель согласен с этим, то он посылает в ответ другой служебный пакет, подтверждающий установление соединения и предлагающий некоторые параметры, которые должны использоваться в рамках данного логического соединения.
Узел — инициатор соединения может закончить процесс установления соединения отправкой третьего служебного пакета, в котором сообщит, что предложенные параметры ему подходят.
2. Передача данных. После того как соединение установлено и все параметры согласованы, конечные узлы начинают передачу собственно данных. Логическое соединение может быть рассчитано на передачу данных как в одном направлении (от инициатора соединения), так и в обоих направлениях.
3. Разрыв логического соединения. После передачи некоторого законченного набора данных, например определенного файла, узел-отправитель инициирует процедуру разрыва логического соединения, аналогичную процедуре установления соединения.

В отличие от передачи дейтаграммного типа, в которой поддерживается только один тип пакетов — информационный, передача с установлением соединения должна поддерживать как минимум два типа пакетов — **информационные пакеты** переносят собственно пользовательские данные, а **служебные** предназначаются для установления (разрыва) соединения.

Передача с установлением соединения имеет важное отличие от дейтаграммной передачи, поскольку в ней, помимо обработки пакетов на коммутаторах, имеет место **дополнительная обработка пакетов на конечных узлах**.
Например, если при установлении соединения была оговорена передача данных в зашифрованном виде, то шифрование пакетов выполняется узлом-отправителем, а дешифрование — узлом-получателем.
Аналогично, для обеспечения в рамках логического соединения надежности всю работу по нумерации пакетов, отслеживанию номеров доставленных и недоставленных пакетов, посылке копий и отбрасыванию дубликатов берут на себя конечные узлы.

Передача с установлением соединения предоставляет больше возможностей в плане надежности и безопасности обмена данными, чем дейтаграммная передача. Однако этот способ более медленный, так как он подразумевает дополнительные вычислительные затраты на установление и поддержание логического соединения.

### Передача с установлением виртуального канала
Следующий способ продвижения данных в пакетных сетях основан на частном случае логического соединения, в число параметров которого входит жестко определенный для всех пакетов маршрут. То есть все пакеты, передаваемые в рамках данного соединения, должны проходить строго по одному и тому же закрепленному за этим соединением пути.

Единственный заранее проложенный фиксированный маршрут, соединяющий конечные узлы в сети с коммутацией пакетов, называют **виртуальным каналом (virtual circuit, или virtual channel)**.

Виртуальные каналы прокладываются для **устойчивых** информационных потоков. С целью выделения потока данных из общего трафика каждый пакет этого потока помечается признаком особого вида — меткой.

После прокладки виртуального канала сеть может передавать по нему соответствующий поток данных. Во всех пакетах, которые переносят пользовательские данные, адрес назначения уже не указывается, его роль играет метка виртуального канала. При поступлении пакета на входной интерфейс коммутатор читает значение метки из заголовка пришедшего пакета и просматривает свою таблицу коммутации, по которой определяет, на какой выходной порт передать пришедший пакет.

Таблица коммутации в сетях, использующих виртуальные каналы, отличается от таблицы коммутации в дейтаграммных сетях. Она содержит записи *только о проходящих через коммутатор виртуальных каналах*, а не обо всех возможных адресах назначения, как это имеет место в сетях с дейтаграммным алгоритмом продвижения.
Обычно в крупной сети количество проложенных через узел виртуальных каналов существенно меньше общего количества узлов, поэтому таблицы коммутации в этом случае намного короче и, следовательно, анализ такой таблицы занимает у коммутатора меньше времени. По той же причине метка короче адреса конечного узла, и заголовок пакета в сетях с виртуальными каналами переносит по сети вместо длинного адреса компактный идентификатор потока.

В одной и той же сетевой технологии могут быть задействованы разные способы продвижения данных. Так, для передачи данных между отдельными сетями, составляющими Интернет, используется дейтаграммный протокол IP. В то же время обеспечением надежной доставки данных между конечными узлами этой сети занимается протокол TCP, устанавливающий логические соединения без фиксации маршрута. И наконец, Интернет — это пример сети, применяющей технику виртуальных каналов, так как в состав Интернета входит немало сетей MPLS, поддерживающих виртуальные каналы.

## Сравнение сетей с коммутацией пакетов и каналов
### Структура задержек в сетях с коммутацией каналов и пакетов
*В сети с коммутацией каналов* данные после задержки, связанной с установлением канала, начинают передаваться на стандартной для канала скорости. Время доставки данных адресату (Т) равно сумме времени распространения сигнала в канале t prg (prg — propagation) и времени передачи сообщения в канал t trns (trns — transmission), называемого также временем сериализации.
Наличие коммутаторов в сети с коммутацией каналов никак не влияет на суммарное время прохождения данных через сеть.

Время распространения сигнала зависит от расстояния между абонентами L и скорости S распространения электромагнитных волн в конкретной физической среде, которая колеблется от 0,6 до 0,9 скорости света в вакууме

Время сериализации (а значит, и время буферизации в узле назначения) равно отношению объема сообщения V в битах к пропускной способности канала C в битах в секунду

**В сети с коммутацией пакетов** передача данных не требует обязательного установления соединения.
Однако разбиение передаваемого сообщения на пакеты с последующей их передачей по сети с коммутацией пакетов приводит к дополнительным задержкам.

Во-первых, время тратится в узле-отправителе N1:
* t 1 — время формирования пакета, также называемое временем пакетизации (зависит от различных параметров работы программного и аппаратного обеспечения узла отправителя и не зависит от параметров сети);
* t 2 — время передачи в канал заголовка;
* t 3 — время передачи в канал поля данных пакета;
* t 4 — дополнительное время тратится на распространение сигналов по каналам связи между узлом-отправителем и коммутатором (коммутатором и коммутатором).
Дополнительное время тратится в промежуточном коммутаторе:
* t 5 — время приема пакета с его заголовком из канала во входной буфер коммутатора; как отмечено, это время равно (t 2 + t 3 ), то есть времени передачи пакета с заголовком в канал из узла источника;
* t 6 — время ожидания пакета в очереди, колеблется в очень широких пределах и заранее не известно, так как зависит от текущей загрузки сети;
* t 7 — время коммутации пакета при его передаче в выходной порт, фиксировано для конкретной модели и обычно невелико (от нескольких микросекунд до нескольких миллисекунд)

# Chapter 4. Стандартизация и классификация сетей
## Декомпозиция задачи сетевого взаимодействия
**Сетевая архитектура** — это концептуальная схема функционирования компьютерной сети, определяющая принципы работы аппаратных и программных сетевых компонентов, организацию их связей, протоколы взаимодействия и способы физической передачи данных. Архитектура сети отражает декомпозицию общей задачи взаимодействия компьютеров на отдельные *подзадачи, которые должны решаться отдельными компонентами сети* — конечными узлами (компьютерами) и промежуточными узлами (коммутаторами и маршрутизаторами).

### Многоуровневый подход
**Межуровневый интерфейс**, называемый также **интерфейсом услуг**, определяет набор функций, которые нижележащий уровень предоставляет вышележащему.

### Протокол и стек протоколов
В процессе обмена сообщениями участвуют, по меньшей мере, две стороны, то есть в данном случае необходимо организовать согласованную работу двух иерархий аппаратных и программных средств на разных компьютерах.

Модель взаимодействия двух узлов.
Это *одноранговый интерфейс* со средствами взаимодействия другой стороны, расположенными на том же уровне иерархии. Этот тип интерфейса называют **протоколом**.

В сущности, термины «протокол» и «интерфейс» обозначают одно и то же — формализованное описание процедуры взаимодействия двух объектов, но традиционно в сетях за ними закрепили разные области предпочтительного использования: протоколы определяют правила взаимодействия модулей одного уровня (одного ранга) в разных узлах, а интерфейсы — правила взаимодействия модулей соседних уровней в одном узле.

Иерархически организованный набор протоколов, достаточный для организации взаимодействия узлов в сети, называется **стеком протоколов**.

Протоколы нижних уровней часто реализуются комбинацией программных и аппаратных средств, а протоколы верхних уровней, как правило — программными средствами. Программный модуль, реализующий некоторый протокол, называют **протокольной сущностью**, или, для краткости, тоже протоколом.

Протокольные сущности одного уровня обмениваются сообщениями в соответствии с определенным для них протоколом. Сообщения состоят из заголовка и поля данных (иногда оно может отсутствовать). Обмен сообщениями является своеобразным языком общения, с помощью которого каждая из сторон «объясняет» другой стороне, что необходимо сделать на каждом этапе взаимодействия. Работа каждого протокольного модуля состоит в интерпретации заголовков поступающих к нему сообщений и выполнении связанных с этим действий.

## Модель OSI
В начале 80-х годов ряд международных организаций по стандартизации, в частности International Organization for Standartization, часто называемая International Standards Organization (ISO), а также International Telecommunications Union (ITU) и некоторые другие разработали стандартную модель взаимодействия открытых систем **(Open System Interconnection, OSI)**.

### Общая характеристика модели OSI
**Модель OSI** имеет дело со стеком протоколов для сетей с коммутацией пакетов. Модель OSI не содержит описаний реализаций конкретного набора протоколов. Она лишь определяет, во-первых, уровни взаимодействия, во-вторых, стандартные названия уровней, в-третьих, функции, которые должен выполнять каждый уровень.
В модели OSI средства взаимодействия делятся на семь уровней:
* прикладной (application layer);
* представления (presentation layer);
* сеансовый (session layer);
* транспортный (transport layer);
* сетевой (network layer);
* канальный (data link layer);
* физический (physical layer).

Приложения могут реализовывать собственные протоколы взаимодействия, используя для этих целей многоуровневую совокупность системных средств. Именно для этого в распоряжение программистов предоставляется прикладной программный интерфейс **(Application Program Interface, API)**. В соответствии с моделью OSI приложение может обращаться с запросами только к самому верхнему уровню — прикладному, однако на практике многие стеки коммуникационных протоколов предоставляют возможность программистам напрямую обращаться к сервисам или службам нижележащих уровней.

В стандартах ISO для обозначения единиц обмена данными, с которыми имеют дело протоколы разных уровней, используется общее название протокольная единица данных (Protocol Data Unit, PDU). Для обозначения единиц обмена данными конкретных уровней часто используются специальные названия, в частности: сообщение, кадр, пакет, дейтаграмма, сегмент.

Протоколы нижних четырех уровней обобщенно называют сетевым транспортом, или транспортной подсистемой, так как они полностью решают задачу транспортировки сообщений с заданным уровнем качества в составных сетях с произвольной топологией и различными технологиями. Оставшиеся три верхних уровня объединяет то, что они тесно связаны с пользовательскими приложениями, предоставляя им высокоуровневые услуги по использованию сетевых ресурсов и сервисов.

### Физический уровень
**Физический уровень** модели OSI имеет дело с передачей потока битов по физическим каналам связи, таким как коаксиальный кабель, витая пара, оптоволоконный кабель или беспроводная линия связи.

Функции физического уровня реализуются на всех устройствах, подключенных к сети.  Со стороны компьютера эти функции выполняются сетевым адаптером, со стороны промежуточных сетевых устройств — коммутаторов, маршрутизаторов, мультиплексоров и др. — входными и выходными интерфейсами (портами).

Физический уровень не вникает в смысл информации, которую он передает. Для него информация, поступающая от вышележащего канального уровня, представляет собой однородный поток битов, которые нужно доставить без искажений, в соответствии с заданной тактовой частотой (интервалом между соседними битами) и выбранным способом кодирования.

### Канальный уровень
**Канальный уровень**, используя возможности, предоставляемые ему нижележащим, физическим, уровнем, предлагает вышележащему, сетевому, уровню следующие услуги:
* установление логического соединения между взаимодействующими узлами;
* согласование в рамках соединения скоростей передатчика и приемника информации;
* обеспечение надежной передачи, обнаружение и коррекцию ошибок.
В сетях, построенных на основе разделяемой среды, физический уровень выполняет еще одну функцию — проверяет доступность разделяемой среды. Эту функцию иногда выделяют в отдельный подуровень управления доступом к среде **(Medium Access Control, MAC)**.

Протокол канального уровня обычно работает в пределах сети, являющейся одной из частей более крупной составной сети, объединенной протоколами сетевого уровня. Адреса, с которыми работает протокол канального уровня, используются для доставки кадров только в пределах этой сети, а для перемещения пакетов между сетями применяются адреса уже следующего, сетевого уровня.

Протокольной единицей данных канального уровня является **кадр**. В поле данных кадра размещается сообщение сетевого уровня, а в заголовке — служебная информация, включающая адрес назначения, на основании которого коммутаторы сети будут продвигать пакет.
Одной из задач канального уровня является **обнаружение и коррекция ошибок**. Канальный уровень может обеспечить надежность передачи, например, путем фиксирования границ кадра, помещая специальную последовательность битов в его начало и конец, а затем добавляя к кадру контрольную сумму.

Прежде чем переправить кадр физическому уровню для непосредственной передачи данных в сеть, подуровень MAC канального уровня должен **проверить доступность среды**.
Если разделяемая среда освободилась (когда она не используется, такая проверка пропускается), то кадр передается средствами физического уровня в сеть.

### Сетевой уровень
**Сетевой уровень** служит для образования единой транспортной системы, объединяющей несколько сетей и называемой **составной сетью**, или **интернетом** (с маленькой буквы).
Технология, позволяющая соединять в единую сеть множество сетей, в общем случае построенных на основе разных технологий, называется технологией **межсетевого взаимодействия** (internetworking).

Чтобы связать между собой сети, построенные на основе отличающихся технологий (Ethernet, FDDI, ATM, Frame Relay, etc.), нужны дополнительные средства, предоставляемые сетевым уровнем.
Функции сетевого уровня реализуются:
* группой протоколов;
* специальными устройствами — маршрутизаторами.

Одной из функций маршрутизатора является **физическое соединение сетей**. Маршрутизатор имеет несколько сетевых интерфейсов, подобных интерфейсам компьютера, к каждому из которых может быть подключена одна сеть. Таким образом, интерфейсы маршрутизатора можно считать узлами разных сетей. Маршрутизатор может быть реализован программно на базе универсального компьютера (например, типовая конфигурация Unix или Windows включает программный модуль маршрутизатора). Однако чаще маршрутизаторы реализуются на базе специализированных аппаратных платформ. В состав программного обеспечения маршрутизатора входят протокольные модули сетевого уровня.

Чтобы связать сети, необходимо соединить их маршрутизаторами и установить протокольные модули сетевого уровня на все конечные узлы пользователей, которые хотели бы связываться через составную сеть.

Данные, которые необходимо передать через составную сеть, поступают на сетевой уровень от вышележащего транспортного уровня. Эти данные снабжаются заголовком сетевого уровня. Данные вместе с заголовком образуют **пакет** — так называется протокольная единица данных сетевого уровня.
Заголовок пакета сетевого уровня наряду с другой служебной информацией несет данные об адресе назначения этого пакета. Чтобы протоколы сетевого уровня могли доставлять пакеты любому узлу составной сети, эти узлы должны иметь *адреса, уникальные в пределах всей составной сети*. Такие адреса называются **сетевыми** или **глобальными**. Каждый узел составной сети, который намерен обмениваться данными с другими узлами составной сети, наряду с адресом, назначенным ему на канальном уровне, должен иметь сетевой адрес.

**Определение маршрута** является важной задачей сетевого уровня. Маршрут описывается последовательностью сетей (или маршрутизаторов), через которые должен пройти пакет, чтобы попасть к адресату.

Маршрутизатор собирает информацию о топологии связей между сетями и на основе этой информации строит таблицы коммутации, которые в данном случае носят специальное название **таблиц маршрутизации**.

Чтобы передать пакет через очередную сеть, сетевой уровень помещает его в поле данных кадра соответствующей канальной технологии. В заголовке кадра указывается **адрес канального уровня** интерфейса следующего маршрутизатора. Сеть, используя свою канальную технологию, доставляет кадр с инкапсулированным в него пакетом по заданному адресу.
Маршрутизатор извлекает пакет из прибывшего кадра и после необходимой обработки передает пакет для дальнейшей транспортировки в следующую сеть, предварительно упаковав его в новый кадр канального уровня в общем случае другой технологии. Таким образом, сетевой уровень играет роль **координатора**, организующего совместную работу сетей, построенных на основе разных технологий.

В заключение отметим, что на сетевом уровне определяются два вида протоколов.
1. **Маршрутизируемые протоколы** — реализует продвижение пакетов через сеть.
Именно эти протоколы обычно имеют в виду, когда говорят о протоколах сетевого уровня.
2. **Маршрутизирующие протоколы**, или протоколы маршрутизации. С помощью этих протоколов маршрутизаторы собирают информацию о топологии межсетевых соединений, на основании которой осуществляется выбор маршрута продвижения пакетов.

### Транспортный уровень
**Транспортный уровень** обеспечивает приложениям и верхним уровням стека — прикладному, представления и сеансовому — передачу данных с той степенью надежности, которая им требуется.

Все протоколы, начиная с транспортного уровня и выше, реализуются программными средствами конечных узлов сети — компонентами их сетевых операционных систем. В качестве примера транспортных протоколов можно привести протоколы TCP и UDP стека TCP/IP и протокол SPX стека Novell.

### Сеансовый уровень
**Сеансовый уровень** управляет взаимодействием сторон: фиксирует, какая из сторон является активной в настоящий момент, и предоставляет средства синхронизации сеанса.
Эти средства позволяют в ходе длинных передач сохранять информацию о состоянии этих передач в виде контрольных точек, чтобы в случае отказа можно было вернуться назад к последней контрольной точке, а не начинать все с начала. На практике немногие приложения используют сеансовый уровень, который редко реализуется в виде отдельных протоколов. Функции этого уровня часто объединяют с функциями прикладного уровня и реализуют в одном протоколе.

### Уровень представления
**Уровень представления**, как явствует из его названия, обеспечивает представление передаваемой по сети информации, не меняя при этом ее содержания. За счет уровня представления информация, передаваемая прикладным уровнем одной системы, всегда понятна прикладному уровню другой системы. С помощью средств данного уровня протоколы прикладных уровней могут преодолеть синтаксические различия в представлении данных или же различия в кодах символов, например кодов ASCII и EBCDIC. На этом уровне могут выполняться шифрование и дешифрование данных, благодаря которым секретность обмена данными обеспечивается сразу для всех прикладных служб. Примером такого протокола является протокол SSL (Secure Socket Layer), который обеспечивает секретный обмен сообщениями для протоколов прикладного уровня стека TCP/IP.
Для повышения эффективности обмена текстами и графическими изображениями уровень представления может оказывать услуги по сжатию/распаковке информации.
К функциям уровня представления относится также кодирование графических изображений

### Прикладной уровень
В качестве функций прикладного уровня модель OSI определяет предоставление разнообразных услуг пользовательским приложениям — таких, как доступ к общим сетевым ресурсам (файлам, принтерам или веб-страницам) или распределенным сетевым сервисам (электронной почте, службам передачи сообщений, базам данных). Как правило, услуги прикладного уровня включают идентификацию и аутентификацию участников сетевого взаимодействия, проверку их доступности и полномочий, определение требований к защищенности сеанса обмена и т. д.

P. S. Для сетей с коммутацией пакетов сети с коммутацией каналов предоставляют сервис физического уровня, хотя сами они устроены достаточно сложно и поддерживают собственную иерархию протоколов.

## Стандартизация сетей
Суть сети — это соединение разного оборудования, а значит, проблема совместимости является здесь одной из наиболее острых.
В компьютерных сетях идеологической основой стандартизации является рассмотренная выше модель взаимодействия открытых систем (OSI).

### Понятие открытой системы
**Открытой** может быть названа любая система (компьютер, вычислительная сеть, ОС, программный пакет, другие аппаратные и программные продукты), которая построена в соответствии с открытыми спецификациями.
Напомним, что под термином «спецификация» в вычислительной технике понимают формализованное описание аппаратных или программных компонентов, способов их функционирования, взаимодействия с другими компонентами, условий эксплуатации, особых характеристик. Понятно, что не всякая спецификация является стандартом.
Под **открытыми спецификациями** понимаются опубликованные, общедоступные спецификации, соответствующие стандартам и принятые в результате достижения согласия после всестороннего обсуждения всеми заинтересованными сторонами.

Время закрытых систем, точные спецификации на которые были известны только фирме-производителю, ушло. Все осознали, что возможность взаимодействия с продуктами конкурентов не снижает, а, наоборот, повышает ценность изделия, так как позволяет применять его в большем количестве работающих сетей, собранных из продуктов разных производителей.

Для реальных систем полная открытость является недостижимым идеалом. Как правило, даже в системах, называемых открытыми, этому определению соответствуют лишь некоторые части, поддерживающие внешние интерфейсы. Например, открытость семейства операционных систем Unix заключается, помимо всего прочего, в наличии стандартизованного программного интерфейса между ядром и приложениями, что позволяет легко переносить приложения из среды одной версии Unix в среду другой версии.
Модель OSI касается только одного аспекта открытости, а именно открытости средств взаимодействия устройств, связанных в компьютерную сеть. Здесь под открытой системой понимается сетевое устройство, готовое взаимодействовать с другими сетевыми устройствами по стандартным правилам, определяющим формат, содержание и значение принимаемых и отправляемых сообщений.

Если две сети построены с соблюдением принципов открытости, то это дает следующие преимущества:
* возможность построения сети из аппаратных и программных средств различных производителей, придерживающихся одного и того же стандарта;
* безболезненная замена отдельных компонентов сети другими, более совершенными, что позволяет сети развиваться с минимальными затратами;
* легкость сопряжения одной сети с другой.

### Стандартизация Интернета
Само название стандартов, определяющих работу Интернета, — темы для обсуждения **(Request For Comments, RFC)** — показывает гласный и открытый характер принимаемых стандартов. В результате Интернет сумел объединить в себе разнообразное оборудование и программное обеспечение огромного числа сетей, разбросанных по всему миру.

Существует несколько организационных подразделений, отвечающих за развитие и, в частности, за стандартизацию архитектуры и протоколов Интернета. Основным из них является научно-административное сообщество Интернета **(Internet Society, ISOC)**, объединяющее около 100 000 человек, которое занимается социальными, политическими и техническими проблемами эволюции Интернета.

Под управлением ISOC работает совет по архитектуре Интернета (Internet Architecture Board, IAB). В IAB входят две основные группы: **Internet Research Task Force (IRTF)** и **Internet Engineering Task Force** (IETF). IRTF координирует долгосрочные исследовательские проекты по протоколам TCP/IP. IETF — это инженерная группа, которая занимается решением текущих технических проблем Интернета. Именно IETF определяет спецификации, которые затем становятся стандартами Интернета.

## Информационные и транспортные услуги
Услуги компьютерной сети можно разделить на две категории:
* транспортные услуги;
* информационные услуги.

**Транспортные услуги** состоят в передаче информации между пользователями сети в неизменном виде. При этом сеть принимает информацию от пользователя на одном из своих интерфейсов, передает ее через промежуточные коммутаторы и выдает другому пользователю через другой интерфейс. При оказании транспортных услуг сеть не вносит никаких изменений в передаваемую информацию, передавая ее получателю в том виде, в котором она поступила в сеть от отправителя. Примером транспортной услуги глобальных сетей является объединение локальных сетей клиентов.
**Информационные услуги** состоят в предоставлении пользователю некоторой новой информации. Информационная услуга всегда связана с операциями по обработке информации: хранению ее в некотором упорядоченном виде (файловая система, база данных, веб-сайт), поиску нужной информации и преобразованию информации.

В компьютерных сетях одинаково важны обе категории услуг. Благодаря этой особенности новое поколение телекоммуникационных сетей иногда называют **инфокоммуникационными сетями**.

### Распределение протоколов по элементам сети
Полный стек протоколов реализован только на конечных узлах, а коммуникационным устройствам для продвижения пакетов достаточно функциональности нижних трех уровней. Более того, коммуникационное устройство может поддерживать только протоколы двух нижних уровней или даже одного физического уровня — это
зависит от типа устройства.
Именно к таким устройствам, работающим на физическом уровне, относятся, например, **сетевые повторители**, называемые также **концентраторами или хабами**. Они повторяют электрические сигналы, поступающие на одни их интерфейсы, на других своих интерфейсах, улучшая характеристики сигналов — мощность и форму, синхронность их следования.
**Коммутаторы локальных сетей** поддерживают протоколы двух нижних уровней, физического и канального, что дает им возможность работать в пределах стандартных топологий.
**Маршрутизаторы** должны поддерживать протоколы всех трех уровней, так как сетевой уровень нужен им для объединения сетей различных технологий, а протоколы нижних уровней — для взаимодействия с конкретными сетями, образующими составную сеть, например, Ethernet или Frame Relay.
**Коммутаторы глобальных сетей** (например, MPLS), работающие на основе технологии виртуальных каналов, могут поддерживать как два уровня протоколов, так и три. Протокол сетевого уровня нужен им в том случае, если они поддерживают процедуры автоматического установления виртуальных каналов.

Компьютеры, на которых работают сетевые приложения, должны поддерживать протоколы всех уровней. Протоколы прикладного уровня, пользуясь сервисами протоколов уровня представления и сеансового уровня, предоставляют приложениям набор сетевых услуг в виде сетевого прикладного программного интерфейса (API). Протокол транспортного уровня также работает на всех конечных узлах. При передаче данных через сеть два модуля транспортного протокола, работающие на узле-отправителе и узле-получателе, взаимодействуют друг с другом для поддержания транспортного сервиса нужного качества. Коммуникационные устройства сети переносят сообщения транспортного протокола прозрачным образом, не вникая в их содержание.
Конечные узлы сети (компьютеры и компьютеризованные устройства, например мобильные телефоны) всегда предоставляют как информационные, так и транспортные услуги, а промежуточные узлы сети — только транспортные. Когда мы говорим, что некоторая сеть предоставляет только транспортные услуги, то подразумеваем, что конечные узлы находятся за границей сети. Это обычно имеет место в обслуживающих клиентов коммерческих сетях.
Если же говорят, что сеть предоставляет также информационные услуги, то это значит, что компьютеры, предоставляющие эти услуги, включаются в состав сети.

### Вспомогательные протоколы транспортной системы
В реальных сетях некоторые из коммуникационных устройств поддерживают не только протоколы трех нижних уровней, но и протоколы верхних уровней.
Так, маршрутизаторы реализуют протоколы маршрутизации, позволяющие автоматически строить таблицы маршрутизации, а концентраторы и коммутаторы часто поддерживают протоколы SNMP и telnet, которые не нужны для выполнения основных функций этих устройств, но позволяют конфигурировать их и управлять ими удаленно. Существуют также DNS-сервера, которые отображают символьные имена хостов на их IP-адреса, и без этой вспомогательной функции нормальная работа в Интернете практически невозможна.

При **горизонтальном делении** все протоколы (как основные, так и вспомогательные) разделяют на три слоя (planes):
* пользовательский слой (user plane) включает группу основных протоколов, то есть протоколов, которые переносят пользовательский трафик;
* слой управления (control plane) составляют вспомогательные протоколы, необходимые для работы основных протоколов сети, например, протоколы маршрутизации, протоколы отображения имен на IP-адреса;
* слой менеджмента (management plane) объединяет вспомогательные протоколы, поддерживающие операции менеджмента (управления сетью администратором), такие как протокол SNMP для сбора информации об ошибках, протоколы удаленного конфигурирования устройств.

### Классификация компьютерных сетей
**Классификация** — это процесс группирования, то есть отнесения к тому или иному типу объектов изучения в соответствии с их общими признаками.

Начнем с того, что компьютерные сети — составляющая классификации телекоммуникационных сетей, которые по виду передаваемого контента делятся на:
* радиосети;
* телефонные сети;
* телевизионные сети;
* компьютерные сети.
В зависимости от **территории покрытия** компьютерные сети можно разделить на три группы:
* локальные сети (Local Area Network, LAN);
* глобальные сети (Wide Area Network, WAN);
* городские сети, или сети мегаполиса (Metropolitan Area Network, MAN).

Мы уже обозначили особенности этих групп сетей, когда рассматривали в главе 1 эволюцию компьютерных сетей. В частности, в локальных сетях качество линий связи между узлами обычно выше, чем в глобальных сетях. Это обусловлено различными причинами:
* существенно меньшей длиной линий связи (метры вместо сотен километров), а значит, и меньшими искажениями сигналов, вносимых неидеальной передающей средой;
* меньшим уровнем внешних помех, так как в локальной сети оборудование и кабели обычно размещаются в специальных защищенных экранированных помещениях, а линии связи глобальной сети могут проходить в сильно электромагнитно «зашумленной» среде, например, в туннелях подземных коммуникаций, рядом с силовыми кабелями, вдоль линий электропередач и т. п.;
* экономическими соображениями.
Высокое качество линий связи и низкий уровень помех позволили упростить процедуры передачи данных в технологиях локальных сетей, например, применять простые методы кодирования и модулирования сигналов, отказаться от сложных алгоритмов восстановления искаженных данных.

В соответствии с технологическими признаками, обусловленными **средой передачи**, компьютерные сети подразделяют на два класса:
* проводные сети — сети, каналы связи которых построены с использованием медных или оптических кабелей;
* беспроводные сети — сети, в которых для связи используются беспроводные каналы связи, например, радио, СВЧ, инфракрасные или лазерные каналы.
Любая беспроводная среда — будь то радиоволны, инфракрасные лучи или СВЧ-сигналы спутниковой связи — гораздо больше подвержена влиянию внешних помех, чем проводная.
Роса, туман, солнечные бури, работающие в комнате микроволновые печи — вот только несколько примеров источников помех, которые могут привести к резкому ухудшению качества беспроводного канала. А значит, технологии беспроводных сетей должны учитывать типичность подобных ситуаций и строиться таким образом, чтобы обеспечивать работоспособность сети, несмотря на ухудшение внешних условий.

В зависимости от **способа коммутации**, сети подразделяются на два фундаментально различных класса:
* сети с коммутацией пакетов;
* сети с коммутацией каналов.

В свою очередь, техника коммутации пакетов допускает несколько вариаций, отличающихся способом продвижения пакетов, в соответствии с чем сети делятся на:
* дейтаграммные сети, например Ethernet;
* сети, основанные на логических соединениях, например, IP-сети, использующие на транспортном уровне протокол TCP;
* сети, основанные на виртуальных каналах, например MPLS-сети.
Сети могут быть классифицированы на основе **топологии**. Топологический тип сети весьма отчетливо характеризует сеть, он понятен как профессионалам, так и пользователям. Мы подробно рассматривали базовые топологии сетей, поэтому здесь только перечислим их: полносвязная топология, дерево, звезда, кольцо, смешанная топология.

В зависимости от **функциональной роли**, которую играют некоторые части сети, ее относят к сети доступа, магистральной сети или сети агрегирования трафика. Поясним, что:
* Сети доступа — это сети, предоставляющие доступ индивидуальным и корпоративным абонентам от их помещений (квартир, офисов) до первого помещения (пункта присутствия) оператора сети связи или оператора корпоративной сети. Другими словами, это сети, ответственные за расширение глобальной сети до помещений ее клиентов.
* Магистральные сети — это сети, представляющие собой наиболее скоростную часть (ядро) глобальной сети, которая объединяет многочисленные сети доступа в единую сеть.
* Сети агрегирования трафика — это сети, агрегирующие данные от многочисленных сетей доступа для компактной передачи их по небольшому числу каналов связи в магистраль. Сети агрегирования обычно используются только в крупных глобальных сетях, где они занимают промежуточную позицию, помогая магистральной сети обрабатывать трафик, поступающий от большого числа сетей доступа. В сетях среднего и небольшого размера сети агрегирования обычно отсутствуют.

Различают также первичные и наложенные телекоммуникационные сети:
* Первичные сети занимают особое положение в мире телекоммуникационных сетей, их можно рассматривать как вспомогательные сети, позволяющие гибко создавать постоянные физические двухточечные каналы для других компьютерных и телефонных сетей. В соответствии с семиуровневой моделью OSI первичные сети, подобно простым кабелям, выполняют функции физического уровня сетей. Однако в отличие от кабелей первичные сети включают дополнительное коммуникационное оборудование, которое путем соответствующего конфигурирования позволяет прокладывать новые физические каналы между конечными точками сети. Другими словами, первичная сеть — это гибкая среда для создания физических каналов связи.
* Наложенные сети в этой классификации — это все остальные сети, которые предоставляют услуги конечным пользователям и строятся на основе каналов первичных сетей — «накладываются» поверх этих сетей. Так, и компьютерные, и телефонные, и телевизионные сети являются наложенными.

В зависимости от того, какому **типу пользователей** предназначаются услуги сети, последние делятся на сети операторов связи, корпоративные и персональные сети.
* Сети операторов связи предоставляют публичные услуги, то есть клиентом сети может стать любой индивидуальный пользователь или любая организация, которая заключила соответствующий коммерческий договор на предоставление той или иной телекоммуникационной услуги.
* Корпоративные сети предоставляют услуги только сотрудникам предприятия, которое владеет этой сетью. Хотя формально корпоративная сеть может иметь любой размер, обычно под корпоративной понимают сеть крупного предприятия, которая состоит как из локальных сетей, так и из объединяющей их глобальной сети.
* Персональные сети находятся в личном использовании. Для них характерно небольшое количество узлов, простая структура, а также небольшой (в пределах 30 метров) радиус действия. Узлами персональной сети наряду с настольными компьютерами могут быть телефоны, смартфоны, планшеты, ноутбуки. Чаще всего персональные сети строятся на основе беспроводных технологий.

**Интернет** представляет собой уникальную сеть, объединяющую практически все компьютерные сети (за исключением, может быть, сетей, остающихся изолированными по причине повышенной секретности) во всемирном масштабе. Если применить к Интернету признаки, описанные в классификации, можно сказать, что это:
* сеть операторов связи, предоставляющая публичные услуги — как информационные, так и транспортные;
* сеть с коммутацией пакетов;
* сеть, состоящая из магистральных сетей, сетей агрегирования трафика и сетей доступа.

# Сетевые характеристики и качество обслуживания
## Типы характеристик
### Требования к характеристикам со стороны пользователя и поставщика услуг
Все множество количественных характеристик качества транспортных услуг сети можно свести к желанию пользователя без потерь и перерывов в обслуживании **(надежность)** передавать с заданной скоростью **(производительность)** защищенную от несанкционированного доступа и подмены **(безопасность)** информацию.

Поскольку сеть обслуживает большое количество клиентов, информационные потоки которых разделяют ресурсы сети — линии связи и коммутаторы (маршрутизаторы), — поставщику необходимо найти такой баланс в распределении ресурсов между конкурирующими потоками, чтобы требования всех пользователей были соблюдены. Решение этой задачи включает планирование и контроль расходования ресурсов в процессе передачи пользовательского трафика.

### Долговременные, среднесрочные и краткосрочные характеристики

**Долговременные характеристики** (или характеристики проектных решений) определяются на промежутках времени от нескольких месяцев до нескольких лет. Примерами таких характеристик являются количество и схема соединения коммутаторов в сети, пропускная способность линий связи, конкретные модели и характеристики используемого оборудования. Эти параметры сети прямо влияют на характеристики качества сетевых услуг. Понятно, что полная замена или глубокая модернизация сети связаны с большими финансовыми и временными затратами, поэтому они не могут происходить часто.

**Среднесрочные характеристики** определяются на интервалах времени от нескольких секунд до нескольких дней. Как правило, за это время происходит обслуживание большого количества пакетов. Например, к среднесрочным характеристикам может быть отнесено усредненное значение задержки пакетов по выборке, взятой в течение суток.

**Краткосрочные характеристики** относятся к темпу обработки отдельных пакетов и измеряются в микросекундном и миллисекундном диапазонах. Например, время буферизации или время пребывания пакета в очереди коммутатора либо маршрутизатора является характеристикой этой группы. Для анализа и обеспечения требуемого уровня краткосрочных характеристик разработано большое количество методов, получивших название методов контроля и предотвращения перегрузок.

## Производительность и надежность сети
### Идеальная и реальная сети
Мы рассмотрели различные составляющие задержек в сети с коммутацией пакетов, а именно:
* время передачи данных в канал (время сериализации);
* время распространения сигнала;
* время ожидания пакета в очереди;
* время коммутации пакета.

Две первые составляющие задержки полностью определяются пропускной способностью каналов передачи данных и являются фиксированными величинами для пакета фиксированной длины.
Две последние составляющие зависят от загрузки коммутаторов и их быстродействия и для пакета фиксированной длины в общем случае являются переменными.
Будем считать, что сеть с коммутацией пакетов работает идеально, если она передает каждый бит информации с постоянной скоростью, равной скорости распространения света в используемой физической среде. Другими словами, идеальная сеть с коммутацией пакетов не вносит никаких дополнительных задержек в передачу данных помимо тех, которые вносятся каналами связи, то есть две последние составляющие задержки равны нулю.

Определим **время задержки пакета** как интервал времени между моментом отправления первого бита пакета в канал связи узлом отправления и моментом поступления первого бита пакета в узел назначения соответственно

Существуют и другие определения времени задержки пакета. Например, эту величину можно определить как время между моментом отправления первого бита пакета в канал связи узлом отправления и моментом поступления последнего бита пакета в узел назначения соответственно (такое определение используется в документе RFC 2679, описывающем характеристики задержек IP-пакетов).

Теперь посмотрим, какие отклонения от идеала могут встречаться в реальной сети и какими характеристиками можно эти отклонения описывать.
* Пакеты доставляются сетью узлу назначения с различными задержками. Это — неотъемлемое свойство сетей с коммутацией пакетов.
Случайный характер процесса образования очередей приводит к случайным задержкам, при этом задержки отдельных пакетов могут быть значительными, в десятки раз превосходя среднюю величину задержек. Неравномерность задержек изменяет относительное положение пакетов в выходном потоке, что может катастрофически сказаться на качестве работы некоторых приложений. Например, при цифровой передаче речи исходный поток представляет собой равномерно отстоящие друг от друга пакеты, несущие замеры голоса. Неравномерность интервалов между пакетами выходного потока приводит к существенным искажениям речи.
* Пакеты могут доставляться узлу назначения не в том порядке, в котором они были отправлены.
* Пакеты могут теряться в сети или же приходить в узел назначения с искаженными данными, что равносильно потере пакета, так как большинство протоколов неспособно восстанавливать искаженные данные, лишь определяя этот факт по значению контрольной суммы в заголовке кадра.
* Пакеты также могут дублироваться по разным причинам, например, из-за ошибочных повторных передач пакета, предпринятых протоколом, в котором таким образом обеспечивается надежный обмен данными.
В реальной сети скорость информационного потока на входе узла назначения может отличаться от скорости потока, направленного в сеть узлом-отправителем. Виной этому являются задержки пакетов в очередях и их потери.

Для оценки отклонения функционирования реальной сети от идеальной используются различные характеристики производительности сети. Одни из них касаются различных аспектов скорости и задержек, другие — потерь и искажений, третьи — безопасности передачи информации передачи пакетов. Относительная важность той или иной характеристики зависит от типа приложения, трафик которого переносит сеть.

### Статистические оценки характеристик сети
Для оценки характеристик случайных процессов служат статистические методы, а именно такой характер имеют процессы передачи пакетов сетью. Сами характеристики производительности сети — как, например, задержка пакета — являются случайными величинами.

Основным инструментом статистики является так называемая **гистограмма распределения** оцениваемой случайной величины.
Каждый результат измерения является единичным значением случайной величины, а в совокупности они образуют выборку значений случайной величины.
Чтобы получить гистограмму распределения, мы должны разбить весь диапазон измеренных значений задержек на несколько интервалов и подсчитать, сколько замеров из выборки попало в каждый интервал.

**Гистограмма задержек** дает хорошее представление о производительности сети. По ней можно судить, какие уровни задержек более вероятны, а какие — менее. Чем больше период времени, в течение которого собираются данные для построения гистограммы, тем с более высокой степенью достоверности можно предсказать поведение сети в будущем.

*При увеличении количества интервалов и времени наблюдения* гистограмма в пределе переходит в **непрерывную функцию**, которая называется плотностью распределения задержки доставки пакета.

Гистограмма дает наглядное представление соответствующей характеристики, но чаще используются более компактные статистические оценки характеристик, которые позволяют представить характеристику одним числом на основе некоторой математической обработки имеющейся выборки.
Для описания характеристик сети используются следующие статистические оценки:
* среднее значение (D) вычисляется как сумма всех значений оцениваемой величины, деленная на количество всех измерений N
* медиана представляет такое значение оцениваемой величины, которое делит ранжированную (упорядоченную) выборку пополам
* стандартное отклонение, или вариация, (J) представляет собой среднее отклонение каждого отдельного замера от среднего значения оцениваемой величины:
* коэффициент вариации (CV) — это безразмерная величина, которая равна отношению стандартного отклонения к среднему значению оцениваемой величины
* квантиль (процентиль) — это значение оцениваемой величины, делящее ранжированную выборку на две части так, что процент замеров, значения которых меньше или равны значению квантиля, равен некоторому заданному уровню.

Статистические методы применяются к различным характеристикам производительности сети — скорости передачи данных, задержкам, времени ожидания в буфере, времени коммутации, количеству потерянных пакетов и др., так как все они являются случайными величинами.
**Последовательность замеров** рекомендуется выполнять в **случайные моменты времени**, подчиняющиеся распределению Пуассона. Такой порядок выбора времени замеров позволяет избежать возможной синхронизации измерений с любыми периодическими флюктуациями в поведении сети, так как подобная синхронизация может существенно исказить наблюдаемую картину.

### Активные и пассивные измерения в сети
Существует два типа измерений в сети: активные и пассивные.
**Активные измерения** основаны на генерации в узле-источнике специальных «измерительных» пакетов. Эти пакеты должны пройти через сеть тем же путем, что и пакеты, характеристики которых мы собираемся оценивать.

Вместо того чтобы пытаться измерить задержки пакетов, генерируемых клиентским компьютером, мы устанавливаем в сети два дополнительных компьютера: сервер-генератор и сервер-измеритель. Сервер-генератор генерирует измерительные пакеты, сервер-измеритель — измеряет задержки этих пакетов.
Чтобы измеряемые значения были близки к значениям задержки пакетов приложения А, нужно, чтобы измерительные пакеты проходили через сеть по тому же пути, что и пакеты приложения А.

Кроме того, требуется, чтобы измерительные пакеты как можно больше «походили» на оригинальные пакеты — размерами, признаками, помещенными в заголовки пакетов.

Измерительные пакеты не должны генерироваться слишком часто, иначе нагрузка сети может существенно измениться, и результаты замеров будут отличаться от тех, которые были бы получены в отсутствие измерительных пакетов. Другими словами, измерения не должны менять условий работы сети.

Активная схема упрощает процесс проведения измерений и позволяет добиться их высокой точности.
**Во-первых**, так как сервер-генератор создает специальные пакеты, предназначенные для измерений, он легко может поместить в них служебную информацию, например, временную отметку (time-stamp) отправки пакета, с тем чтобы сервер-измеритель использовал ее для вычисления времени задержки.
**Во-вторых**, для того чтобы измерения задержки были точными, нужна хорошая синхронизация сервера-генератора и сервера-измерителя. Поскольку в схеме активных измерений они представляют собой специальные узлы, такой синхронизации добиться проще, чем в случае синхронизации клиентской и серверной частей приложения А, которые чаще всего установлены на обычных компьютерах.

**Пассивные измерения** основаны на измерениях характеристик реального трафика.
Приводя аргументы в пользу схемы активных измерений, мы, в сущности, описали проблемы, которые приходится решать при использовании схемы пассивных измерений:
сложности синхронизации клиента и сервера, дополнительные и неопределенные задержки, вносимые универсальными мультипрограммными операционными системами этих компьютеров, отсутствие в заголовке используемых приложением пакетов поля для переноса по сети временной отметки.
Частично эти проблемы решаются за счет применения отдельного сервера-измерителя.
Этот сервер принимает тот же поток пакетов, что и один из узлов, участвующий в обмене пакетами

Чтобы сервер-измеритель получал тот же входной поток пакетов, что и оригинальный узел, обычно прибегают к дублированию измеряемого трафика на порт, к которому подключен сервер-измеритель. Такую функцию, называемую зеркализацией портов, поддерживают многие коммутаторы локальных сетей. Сервер-измеритель может работать под управлением специализированной операционной системы, оптимизированной для выполнения точных измерений временных интервалов.

Сложнее решить проблему синхронизации. Некоторые протоколы переносят временные отметки в своих служебных полях, так что если, например, приложение А использует такой протокол, то часть проблемы решается. Однако и в этом случае остается открытым вопрос о точности системного времени в компьютере клиента приложения А.

### Характеристики задержек пакетов
Для оценки производительности сети используются различные характеристики задержек, в том числе:
* односторонняя задержка пакетов;
* вариация задержки пакета;
* время реакции сети;
* время оборота пакета.
**Единичное значение односторонней задержки пакета** (One-Way Delay Metric, OWD) определенного типа — это интервал времени между моментом помещения в исходящую линию связи первого бита пакета узлом-отправителем и моментом приема последнего бита пакета с входящей линии связи узла-получателя.

Так как в этом определении учитывается время буферизации (сериализации) пакета узлом-получателем, то задержка зависит от размера пакета, и для получения сопоставимых результатов желательно в определении типа пакетов задавать определенный размер пакета.
Определение времени задержки с учетом буферизации упрощает измерение времени прихода пакета, так как программно его можно измерить только после завершения записи всего пакета в буфер операционной системы.

Для некоторых приложений очень важна **вариация задержки пакета**, которую также называют **джиттером (jitter)**. Так, при воспроизведении видеоклипа сама по себе задержка не очень существенна, например, если все пакеты задерживаются ровно на десять секунд, то качество воспроизведения не пострадает, а тот факт, что картинка появляется чуть позже, чем ее отослал сервер, даже не будет замечен пользователем (хотя в интерактивных видеоприложениях, таких как видеоконференции, подобная задержка будет, конечно, уже ощутимо раздражать). А вот если задержки постоянно изменяются в пределах от нуля до 10 секунд, то качество воспроизведения клипа заметно ухудшится, и для компенсации таких переменных задержек нужна предварительная буферизация поступающих пакетов в течение времени, превышающего вариацию задержки.
Единичное значение вариации задержки определяется стандартом как разность односторонних задержек для пары пакетов определенного типа, полученных на интервале измерений T.

**Время реакции сети** определяется как интервал времени между отправкой запроса пользователя к какой-либо сетевой службе и получением ответа на этот запрос.
Время реакции можно представить в виде нескольких слагаемых, например:
* времени подготовки запросов на клиентском компьютере
* времени передачи запросов между клиентом и сервером через сеть
* времени обработки запросов на сервере
* времени передачи ответов от сервера клиенту через сеть
* времени обработки получаемых от сервера ответов на клиентском компьютере

**Время реакции сети** характеризует сеть в целом, в том числе качество работы аппаратного и программного обеспечения серверов. Чтобы отдельно оценить транспортные возможности сети, используется другая характеристика — время оборота данных по сети.

**Время оборота пакета (Round Trip Time, RTT)** определяется как интервал времени между отправкой первого бита пакета определенного типа узлом-отправителем узлу-получателю и получением последнего бита этого пакета узлом-отправителем после того, как пакет был получен узлом-получателем и отправлен обратно.

Время оборота пакета является составляющей времени реакции сети — это «чистое» время транспортировки данных от узла отправителя до узла назначения и обратно без учета времени, затраченного узлом назначения на подготовку ответа.

RTT является удобной для измерений характеристикой, так как для ее получения не требуется синхронизация узла-отправителя и узла-получателя: узел-отправитель ставит временную отметку на отправляемый пакет, а затем по прибытии его от узла-получателя сравнивает эту отметку со своим текущим системным временем. Однако информативность времени оборота меньше, чем односторонней задержки, так как информация о задержке в каждом направлении теряется, а это может затруднить поиск проблемного пути в сети.

### Характеристики скорости передачи
**Скорость передачи данных (information rate)** измеряется на каком-либо промежутке времени и вычисляется как частное от деления объема переданных за этот период данных на продолжительность периода. Она измеряется в кадрах, пакетах, битах или байтах в секунду. Данная характеристика всегда по определению является средней скоростью передачи данных. Однако в зависимости от величины интервала, на котором измеряется скорость, для этой характеристики традиционно используется одно из двух наименований:
средняя или мгновенная скорость.
**Средняя скорость передачи данных (Sustained Information Rate, SIR)** — это среднесрочная характеристика. Она определяется на относительно большом периоде времени, достаточном, чтобы можно было говорить об устойчивом поведении такой случайной величины, которой является скорость. Средняя скорость должна использоваться в паре с параметром, оговаривающим период контроля (период измерения) этой величины, например 10 секунд.
Это означает, что скорость информационного потока вычисляется каждые 10 секунд.

**Мгновенная скорость передачи данных (Instantaneous Information Rate, IIR)** — это краткосрочная характеристика, равная средней скорости на очень коротком интервале времени.
Мгновенная скорость, измеренная на интервале передачи пакета, равна битовой скорости протокола физического уровня и равна нулю в интервалах между передачами пакетов. Все пакеты, передаваемые по каналам связи одного и того же стандарта, имеют одну и ту же мгновенную скорость.

Заметим, что выше мы говорили о скорости передачи отдельного пакета. Другое дело — **скорость потока пакетов**. В этом случае измерение скорости выполняется на относительно большом интервале времени (большем, чем время передачи одного пакета), в течение этого времени может передаваться разное, но, как правило, большое количество пакетов.

Участки, имеющие форму пиков, на которых мгновенная скорость значительно отличается от средней. Такие участки называют **пульсациями**.

**Пиковая скорость передачи данных (Peak Information Rate, PIR)** — это средняя скорость **на периоде пульсации**. Пиковая скорость является краткосрочной характеристикой, она отражает способность сети справляться с пиковыми нагрузками, характерными для пульсирующего трафика и приводящими к перегрузке.

**Величина пульсации** (обычно обозначаемая B от англ. Burst) служит для оценки емкости буфера коммутатора, необходимого для хранения данных во время перегрузки. Величина пульсации равна общему объему данных, поступающих на коммутатор в течение периода пульсации T передачи данных с пиковой скоростью.

Еще одной характеристикой неравномерности передачи данных является **коэффициент пульсации трафика** — это отношение максимальной пиковой скорости к средней скорости трафика, измеренной за длительный период времени.

### Характеристики надежности сети
В качестве характеристики потерь пакетов используется **доля потерянных пакетов** (обозначим ее L), равная отношению количества потерянных пакетов (N L ) к общему количеству переданных пакетов (N):

Для описания надежности отдельных устройств служат такие показатели надежности, как среднее время наработки на отказ, вероятность отказа, интенсивность отказов. Однако эти показатели пригодны только для оценки надежности простых элементов и устройств, которые при отказе любого своего компонента переходят в неработоспособное состояние.
Сложные системы, состоящие из многих компонентов, могут при отказе одного из компонентов сохранять свою работоспособность. В связи с этим для оценки надежности сложных систем применяется другой набор характеристик.
**Доступность (availability)** означает долю времени, в течение которого система или служба находится в работоспособном состоянии.

Еще одной характеристикой надежности сложных систем является **отказоустойчивость (fault tolerance)**. Под отказоустойчивостью понимается способность системы скрывать от пользователя отказ отдельных ее элементов.

В отказоустойчивой системе отказ одного из ее элементов приводит к некоторому снижению качества ее работы — **деградации**, а не к полной ее остановке.

## Характеристики сети поставщика услуг
Рассмотрим основные характеристики, которыми оперирует поставщик услуг, оценивая эффективность своей сети. Эти характеристики — расширяемость, масштабируемость, управляемость и совместимость — являются качественными, то есть не могут быть выражены числами и соотношениями.

**Расширяемость** означает возможность сравнительно простого добавления отдельных компонентов сети (пользователей, компьютеров, приложений, служб)

**Масштабируемость** означает, что сеть позволяет наращивать количество узлов и протяженность связей в очень широких пределах, при этом производительность сети не снижается.

Для обеспечения масштабируемости сети приходится применять дополнительное коммуникационное оборудование и специальным образом структурировать сеть. Обычно масштабируемое решение обладает многоуровневой иерархической структурой, которая позволяет добавлять элементы на каждом уровне иерархии без изменения главной идеи проекта.

**Управляемость сети** подразумевает возможность централизованно контролировать состояние основных элементов сети, выявлять и разрешать проблемы, возникающие при работе сети, анализировать производительность и планировать развитие сети.
Управляемость предполагает наличие в сети некоторых **автоматизированных средств администрирования**, которые взаимодействуют с программным и аппаратным обеспечением сети с помощью коммуникационных протоколов. В идеале средства администрирования сети обеспечивают наблюдение и контроль за каждым элементом сети, и обнаружив проблему, активизируют определенное действие, например, исправляют ситуацию и уведомляют администратора о том, что произошло и какие шаги предприняты. Одновременно с этим система администрирования должна накапливать данные, на основании которых можно планировать развитие сети. Наконец, система администрирования должна быть независима от производителя и обладать удобным интерфейсом, позволяющим выполнять все действия с одной консоли.

**Совместимость, или интегрируемость**, сети означает, что сеть способна включать в себя самое разнообразное программное и аппаратное обеспечение, то есть в ней могут сосуществовать различные операционные системы, поддерживающие разные стеки коммуникационных протоколов, а также аппаратные средства и приложения от разных производителей.
Сеть, состоящая из разнотипных элементов, называется **неоднородной, или гетерогенной**, а если гетерогенная сеть работает без проблем, то она является **интегрированной**.

## Приложения и качество обслуживания
В качестве критериев классификации будем использовать следующие свойства приложений:
* степень равномерности порождаемого ими трафика;
* чувствительность приложений к задержкам пакетов;
* чувствительность приложений к потерям и искажениям пакетов.

### Степень равномерности порождаемого трафика
В отношении равномерности порождаемого трафика приложения делятся на два класса:
приложения с потоковым трафиком и приложения с пульсирующим трафиком.
**Приложения с потоковым трафиком (stream)** порождают равномерный поток данных, который поступает в сеть с **постоянной битовой скоростью (Constant Bit Rate, CBR)**.
В случае коммутации пакетов трафик таких приложений представляет собой последовательность пакетов одинакового размера (равного B бит), следующих друг за другом через один и тот же интервал времени T

**Приложения с пульсирующим трафиком (burst)** отличаются высокой степенью непредсказуемости, в этих приложениях периоды молчания сменяются пульсациями, в течение которых пакеты «плотно» следуют друг за другом. В результате трафик характеризуется **переменной битовой скоростью (Variable Bit Rate, VBR)**.

### Чувствительность приложений к задержкам пакетов

Еще один критерий классификации приложений — их **чувствительность к задержкам пакетов и их вариациям**. Далее перечислены основные типы приложений в порядке повышения чувствительности к задержкам пакетов:
* **асинхронные приложения** практически не имеют ограничений на время задержки **(эластичный трафик)**. Пример такого приложения — электронная почта;
* **интерактивные приложения**. Задержки могут быть замечены пользователями, но они не сказываются негативно на функциональности приложений. Пример — текстовый редактор, работающий с удаленным файлом;
* **изохронные приложения** имеют порог чувствительности к вариациям задержек, при превышении которого резко снижается функциональность приложений. Пример — передача голоса, когда при превышении порога вариации задержек в 100–150 мс искажение голоса становится неприемлемым
* **сверхчувствительные к задержкам приложения**, для которых задержка доставки данных сводит их функциональность к нулю. Пример — приложения, управляющие техническим объектом в реальном времени. При запаздывании управляющего сигнала на объекте может произойти авария.

### Чувствительность приложений к потерям и искажениям пакетов
**Приложения, чувствительные к потере данных**.
Практически все приложения, передающие алфавитно-цифровые данные (к которым относятся текстовые документы, коды программ, числовые массивы и т. п.), обладают высокой чувствительностью к потере отдельных, даже небольших фрагментов данных. Такие потери часто ведут к полному обесцениванию остальной успешно принятой информации. Например, отсутствие хотя бы одного байта в коде программы делает ее совершенно неработоспособной. Все традиционные сетевые приложения (файловый сервис, сервис баз данных, электронная почта и т. д.) относятся к этому типу приложений.

**Приложения, устойчивые к потере данных**. К этому типу относятся многие приложения, передающие трафик с информацией об инерционных физических процессах.
Устойчивость к потерям объясняется тем, что небольшое количество отсутствующих данных можно определить на основе принятых. Так, при потере одного пакета, несущего несколько последовательных замеров голоса, отсутствующие замеры при воспроизведении голоса могут быть заменены аппроксимацией на основе соседних значений.
К такому типу относится большая часть приложений, работающих с мультимедийным трафиком (аудио- и видеоприложения). Однако устойчивость к потерям имеет свои пределы, поэтому процент потерянных пакетов не может быть большим (например, не более 1%). Можно отметить также, что не любой мультимедийный трафик устойчив к потерям данных, так, компрессированный голос и видеоизображение очень чувствительны к потерям, поэтому относятся к первому типу приложений.  

## Методы обеспечения качества обслуживания

**Методы обеспечения качества обслуживания (Quality of Service, QoS)**.
В методах обеспечения качества обслуживания используются различные механизмы, позволяющие снизить негативные последствия временных перегрузок, возникающих в сетях с коммутацией пакетов. Эти механизмы делятся на:
* **средства управления перегрузкой (congestion management)**, которые начинают работать, когда сеть уже перегружена; к ним относится управление очередями;
* **средства предотвращения перегрузок (congestion avoidance)**, которые, как следует из названия, предпринимают превентивные меры для предотвращения перегрузок; к такого рода средствам относится кондиционирование трафика, обратная связь, резервирование ресурсов и трафик-инжиниринг.

**Очереди** являются неотъемлемым атрибутом сетей с коммутацией пакетов. Сам принцип работы таких сетей подразумевает наличие буфера во входных и выходных интерфейсах коммутирующих устройств. Именно буферизация пакетов во время перегрузок является основным механизмом, обеспечивающим высокую производительность сетей этого типа.

Если уровень использования пропускной способности постоянно является достаточно низким, то трафик всех приложений обслуживается с высоким качеством большую часть времени (хотя кратковременные перегрузки сети, приводящие к задержкам и потерям пакетов, все равно возможны, но они случаются редко). Такое состояние сети называется **«недогруженным»** или же используется термин «сеть с избыточной пропускной способностью» (англоязычный термин **overprovisioning**). Постоянно поддерживать все части сети в недогруженном состоянии весьма дорого, но для наиболее ответственной части сети, такой как магистраль, подобный подход применяется и связан с постоянным слежением за уровнем загрузки каналов магистрали и обновлением оборудования с более высокой пропускной способностью по мере приближения загрузки к критическому уровню. Методы QoS основаны на другом подходе.

Идея, лежащая в основе всех методов поддержания характеристик QoS, заключается в следующем: общая производительность каждого ресурса должна делиться между разными классами трафика дифференцированно, с учетом специфических требований приложений разного класса.

Очевидно, что эти методы усложняют сетевые устройства, которые теперь должны «знать» требования всех классов трафика, уметь их распознавать и распределять пропускную способность сети между ними. Последнее свойство обычно достигается за счет использования для каждого выходного интерфейса коммуникационного устройства нескольких очередей пакетов вместо одной очереди; при этом в очередях применяют различные алгоритмы обслуживания пакетов, чем и достигается дифференцированное обслуживание трафика различных классов. Поэтому методы QoS часто ассоциируются с техникой управления очередями.

Помимо собственно техники организации очередей, к методам QoS относят методы контроля параметров потока трафика, так как для гарантированно качественного обслуживания нужно быть уверенными, что обслуживаемые потоки соответствуют набору ограничений, определенному для них. Эта группа методов QoS получила название методов кондиционирования трафика.
Особое место занимают методы обратной связи, которые предназначены для уведомления источника трафика о перегрузке сети. Эти методы рассчитаны на то, что при получении уведомления источник снизит скорость выдачи пакетов в сеть и тем самым ликвидирует причину перегрузки.
К методам QoS тесно примыкают методы инжиниринга трафика. Согласно методам инжиниринга трафика маршруты передачи данных управляются таким образом, чтобы обеспечить сбалансированную загрузку всех ресурсов сети и исключить за счет этого перегрузку коммуникационных устройств и образование длинных очередей.

## Управление очередями
Центральным элементом устройства является коммутирующий блок, который передает данные между тремя своими интерфейсами. Если интенсивности входных потоков и производительность коммутирующего блока таковы, что последний не всегда успевает обработать поступающие пакеты, то избыточные пакеты помещают для ожидания обслуживания во входные очереди (буферы). Когда коммутирующий блок освобождается, специальный блок коммутатора — **арбитр входных очередей**, следуя определенному для него правилу, выбирает очередной пакет из очереди и направляет его на обработку в коммутирующий блок. Таким правилом может быть, например, FIFO «первый пришел — первый ушел» или более сложный алгоритм с учетом приоритетов.

Пакеты, прошедшие обработку в коммутирующем блоке, направляются на один из назначенных для них выходной интерфейс. Из-за случайного характера интервалов между пакетами потока и ограниченного значения пропускной способности выходного интерфейса может возникнуть ситуация перегрузки, когда в момент пульсации трафика очередной пакет не будет принят выходным интерфейсом на передачу. Следовательно, необходимо предусмотреть перед каждым выходным интерфейсом буфер — выходную очередь — для сохранения пакетов на время перегрузки. Пакеты выбираются из выходной очереди и направляются на связанный с ней выходной интерфейс коммутатора в соответствии с правилом, которым руководствуется **арбитр выходных очередей**.

### Анализ очередей
Для уменьшения задержек нужно снижать как коэффициент загрузки ресурса, так и пульсацию потока.

### Очереди и различные классы трафика
Посмотрим, как можно применить знания о зависимости поведения очередей от коэффициента загрузки для реализации основной идеи методов QoS, а именно дифференцированного обслуживания классов трафика с различными требованиями к характеристикам производительности и надежности сети. Для простоты будем пока делить все потоки на два класса:
**чувствительный к задержкам** (трафик реального времени, например голосовой)
**эластичный**, допускающий большие задержки, но чувствительный к потерям данных.

Если обеспечить для чувствительного к задержкам трафика коэффициент загрузки каждого ресурса не более 0,2, то, очевидно, задержки в каждой очереди будут небольшими и, скорее всего, приемлемыми для многих типов приложений этого класса. Для эластичного трафика, слабо чувствительного к задержкам, можно допустить более высокий коэффициент загрузки, но не более 0,9. Чтобы пакеты этого класса не терялись, нужно предусмотреть для них буферную память, достаточную для хранения всех пакетов периода пульсации.

Чтобы добиться различных коэффициентов использования ресурсов для разных классов трафика, нужно в каждом коммутаторе для каждого ресурса поддерживать две разные очереди. Алгоритм выборки пакетов из очередей должен отдавать предпочтение очереди чувствительных к задержкам пакетов.

Асинхронные приложения практически не имеют ограничений на время задержки (эластичный трафик)

### Техника управления очередями
Управление очередями используется для оптимизации работы устройства в периоды временных перегрузок, когда оно не справляется с передачей пакетов на выходной интерфейс в том темпе, в котором они поступают. Алгоритмы управления очередями не предотвращают перегрузок, а лишь некоторым «справедливым» образом в условиях дефицита перераспределяют ресурсы между различными потоками или классами трафика.

#### Очередь FIFO
В **очереди FIFO (First In — First Out)** в случае перегрузки все пакеты помещаются в одну общую очередь и выбираются из нее в том порядке, в котором поступили, то есть в соответствии с принципом «первый пришел — первый ушел». Во всех устройствах с коммутацией пакетов алгоритм FIFO используется по умолчанию. Достоинствами этого подхода являются простота реализации и отсутствие потребности в конфигурировании. Однако ему присущ и коренной недостаток — невозможность дифференцированной обработки пакетов различных потоков. Все пакеты стоят в общей очереди на равных основаниях. Одинаково обслуживаются как пакеты чувствительного к задержкам голосового трафика, так и не- чувствительного к задержкам, но очень интенсивного трафика резервного копирования, длительные пульсации которого могут надолго задержать голосовой пакет.

#### Приоритетное обслуживание
Механизм **приоритетного обслуживания** основан на разделении всего сетевого трафика на небольшое количество классов и последующего назначения каждому классу некоторого числового признака — приоритета.
**Приоритет** — это число, характеризующее степень привилегированности того или иного класса трафика при использовании того или иного сетевого ресурса. Чем выше приоритет, тем меньше времени будут проводить пакеты данного класса в очередях к данному ресурсу.
**Классификация трафика** представляет собой отдельную задачу. Пакеты могут разбиваться на приоритетные классы на основании различных признаков: адрес назначения, адрес источника, идентификатор приложения, генерирующего этот трафик, а равно и любые другие комбинации признаков, которые содержатся в заголовках пакетов. Правила классификации пакетов отражают *политику администрирования сети*. Средства, выполняющие классификацию, — **классификаторы** — могут быть частью сетевых устройств. Масштабируемое решение — размещение механизмов классификации только в устройствах, расположенных на границе сети (например, в коммутаторах корпоративной сети, к которым подключаются компьютеры пользователей, или во входных маршрутизаторах сети поста.

Назначенный приоритет заносится в специальное поле заголовка пакета, после чего им могут воспользоваться остальные сетевые устройства, обрабатывающие трафик после классифицирующего устройства. Если в сети отсутствует централизованная политика назначения приоритетов, то каждое сетевое устройство может не согласиться с приоритетом, назначенным данному пакету в другой точке сети. В этом случае оно перепишет значение приоритета в соответствии со своей локальной политикой.

До тех пор пока из более приоритетной очереди не будут выбраны все имеющиеся в ней пакеты, устройство не переходит к обработке следующей, менее приоритетной очереди. Поэтому пакеты с низким приоритетом обрабатываются только тогда, когда пустеют все вышестоящие очереди.

Если коэффициент нагрузки выходного интерфейса, определяемый только трафиком высшего приоритетного класса, приближается в какой-то период времени к единице, то трафик остальных классов на это время просто замораживается. Поэтому приоритетное обслуживание обычно применяется для чувствительного к задержкам класса трафика, имеющего небольшую интенсивность. При таких условиях обслуживание этого класса не слишком ущемляет обслуживание остального трафика. Например, голосовой трафик чувствителен к задержкам, но его интенсивность обычно не превышает 8–16 Кбит/с, так что при назначении ему высшего приоритета ущерб остальным классам трафика оказывается не очень значительным.

#### Взвешенные очереди
**Механизм взвешенных очередей** разработан для того, чтобы можно было предоставить всем классам трафика определенный минимум пропускной способности. Под весом данного класса понимается доля предоставляемой классу трафика пропускной способности от полной пропускной способности выходного интерфейса.
При взвешенном обслуживании так же, как и при приоритетном, трафик делится на несколько классов, для каждого из которых ведется отдельная очередь пакетов.
Но с каждой очередью связывается не приоритет, а доля пропускной способности ресурса, гарантируемая данному классу трафика при перегрузках этого ресурса. Для входного потока коммутатора таким ресурсом является коммутационный блок, а для выходного (после выполнения коммутации) — выходной интерфейс.

Достигается поставленная цель за счет того, что очереди обслуживаются последовательно и циклически, причем в каждом цикле обслуживания из каждой очереди выбирается такое число байтов, которое соответствует весу данной очереди.

В результате каждому классу трафика достается гарантированный минимум пропускной способности, что во многих случаях является более желательным результатом, чем подавление низкоприоритетных классов высокоприоритетными.

Еще одним вариантом взвешенного обслуживания является **взвешенное справедливое обслуживание (Weighted Fair Queuing, WFQ)**. В случае подобного обслуживания пропускная способность ресурса делится между всеми потоками поровну, то есть «справедливо».
Взвешенное обслуживание обеспечивает требуемые соотношения между интенсивностями трафика различных очередей только в периоды перегрузок, когда каждая очередь постоянно заполнена. Если же какая-нибудь из очередей пуста (то есть для трафика данного класса текущий период не является периодом перегрузки), то при просмотре очередей она игнорируется, а ее время обслуживания распределяется между остальными очередями в соответствии с их весом.

#### Комбинированные алгоритмы обслуживания очередей
Существуют **комбинированные алгоритмы обслуживания очередей**. Например, в одном из алгоритмов подобного рода поддерживается одна приоритетная очередь, а остальные очереди обслуживаются в соответствии со взвешенным алгоритмом. Обычно приоритетная очередь используется для чувствительного к задержкам трафика, а остальные — для эластичного трафика нескольких классов. Каждый класс эластичного трафика получает некоторый минимум пропускной способности при перегрузках. Этот минимум вычисляется как процент от пропускной способности, оставшейся от приоритетного трафика.

## Механизмы кондиционирования трафика
Механизмы кондиционирования трафика:
* классификацию;
* профилирование;
* сглаживание трафика.
Мы уже имели дело с **классификацией трафика** при изучении приоритетных и взвешенных очередей, когда предполагали наличие некоего механизма, решающего, какие пакеты нужно отправить в ту или иную очередь.
В случае кондиционирования механизмы классификации потоков решают более общую задачу — они выполняют динамический анализ проходящих в сети потоков с целью отнесения их к тому или иному классу, каждый из которых должен обслуживаться сетью специфическим образом. К примеру, один класс потоков должен обслуживаться так, чтобы минимизировать потери пакетов, другой — минимизировать задержку, третий — вариацию задержки, а четвертому нужна гарантия пропускной способности. Для подобной классификации используются различные признаки пакетов, например, адреса назначения и источника, тип протокола транспортного или прикладного уровня. Для каждого из классов в общем случае применяются разные методы QoS.

**Профилирование (policing)** представляет собой меру принудительного воздействия на трафик, направленного на ограничение скорости потока пакетов. Цель профилирования — добиться соответствия потока пакетов заданному скоростному профилю — набору заданных параметров потока. В качестве основного параметра обычно выступает средняя скорость потока пакетов, измеренная на определенном интервале времени.

При условии, что физическое оборудование сети остается неизменным, скорость потока пакетов можно уменьшить лишь двумя способами: либо заставить приложение-источник уменьшить интенсивность генерации пакетов (подавление источника), либо **«проредить»** поток.
Последнюю операцию можно выполнить двумя путями:
1. Либо отбрасывать некоторые пакеты из потока,
2. Либо задерживать их на некоторое время в буфере.

**Отбрасывание** и **буферирование** пакетов составляют суть методов **профилирования** и **сглаживания (shaping)** трафика соответственно

Механизм сглаживания трафика задерживает пакеты-нарушители в специальном буфере так, что результирующая скорость потока оказывается в заданных пределах. Пакеты могут также деквалифицироваться, то есть перемещаться в класс обслуживания с более низкими привилегиями, например, переводятся из приоритетного класса в стандартный класс, обслуживаемый «по возможности».

И профилирование и сглаживание устраняют скоростные выступы, **снижая пиковую скорость** кондиционируемого потока.

## Обратная связь для предотвращения перегрузок
Механизмы предотвращения перегрузок основаны на использовании обратной связи, с помощью которой перегруженный узел сети, реагируя на перегрузку, просит предыдущие узлы, расположенные вдоль маршрута следования потока (или потоков, принадлежащих к одному классу), временно снизить скорость трафика. После того как перегрузка в данном узле исчезнет, он посылает сообщение, разрешающее повысить скорость передачи данных.

Существуют несколько видов обратной связи. Они отличаются информацией, которая передается по обратной связи, а также тем, какой тип узла генерирует эту информацию и кто реагирует на эту информацию — конечный узел (компьютер) или промежуточный (коммутатор или маршрутизатор).

**Обратная связь 1** организована между двумя конечными узлами сети. Сообщение о перегрузке порождается узлом-получателем и передается узлу-источнику. Этот вариант, имеющий специальное название — **контроль потока**, обеспечивает наиболее радикальное снижение нагрузки на сеть, так как только узел-источник может снизить скорость поступления информации в сеть. Целью этого вида обратной связи является борьба с перегрузками узла назначения, а не с перегрузками промежуточных сетевых устройств.

В применяемых сегодня методах обратной связи используются следующие основные типы сообщений о перегрузке:
* признак перегрузки;
* максимальная разрешенная скорость передачи;
* максимальный разрешенный объем данных;
* косвенные признаки перегрузки.

**Признак перегрузки** не говорит о степени перегруженности сети или узла, он только фиксирует факт наличия перегрузки. Реакция узла, получившего такое сообщение, может быть разной.

Во втором типе сообщений указывается **максимальная скорость передачи**, то есть порог скорости, который должен соблюдать источник или промежуточный узел, расположенный выше по течению потока. В этом случае обязательно нужно учитывать время передачи сообщения по сети, чтобы исключить колебательные процессы в сети и обеспечить нужную скорость реакции на перегрузку. Поэтому в территориальных сетях такой способ обычно реализуется силами всех коммутаторов сети.

Сообщение о **максимальном объеме данных** используется в широко применяемом в пакетных сетях алгоритме скользящего окна.

В некоторых случаях передающий узел определяет, что принимающий узел (или узлы) испытывает перегрузку, по некоторым **косвенным признакам**, без получения сообщения обратной связи. Такими косвенными признаками могут быть факты потери пакетов. Примером протокола, использующего неявную информацию о перегрузках, является протокол TCP.

## Резервирование ресурсов
Рассмотренные методы поддержания качества обслуживания ориентированы в основном на борьбу с перегрузками или предотвращение их в пределах отдельного узла сети. Вместе с тем понятно, что для поддержания гарантированного уровня качества обслуживания некоторого потока пакетов необходимо скоординированное применение этих методов на всем пути следования потока через сеть.
**Резервирование ресурсов** — это координирующая процедура, которая настраивает механизмы поддержания качества обслуживания вдоль следования потока таким образом, чтобы поток с некоторыми заданными характеристиками скорости был обслужен с заданными характеристиками QoS — задержками, потерями пакетов и др.

Основная идея процедуры резервирования ресурсов состоит в следующем. Перед тем как реальный поток данных будет направлен в сеть, каждому узлу сети вдоль маршрута его следования задается вопрос, может ли этот узел обслужить некоторый новый поток с заданными характеристиками QoS, если известны предельные характеристики скорости потока: средняя и пиковая скорости? Каждый узел при ответе на этот вопрос должен оценить свои возможности, то есть проверить, достаточно ли у него свободных ресурсов, чтобы принять на обслуживание новый поток и обслуживать его качественно. При положительном ответе узел должен некоторым образом зарезервировать часть своих ресурсов для данного потока, чтобы при поступлении пакетов потока на входные интерфейсы использовать эти ресурсы для обслуживания поступающих пакетов с гарантированным уровнем качества.

Процедура резервирования здесь подобна аналогичной процедуре в сетях с коммутацией каналов: определенному потоку данных назначается определенная часть пропускной способности линии связи. Однако в сетях с коммутацией пакетов эта процедура является более гибкой, то есть если отведенная пропускная способность в какой-то период времени недоиспользуется потоком, то она может быть передана другим потокам.

### Процедура резервирования пропускной способности
Резервирование пропускной способности в пакетной сети «из конца в конец» начинается с операции, называемой контролем допуска в сеть потока, который просит зарезервировать для своего обслуживания некоторую пропускную способность сети между ее двумя конечными узлами.
**Контроль допуска в сеть** (admission control) состоит в проверке наличия доступной, то есть незарезервированной для других потоков пропускной способности на каждом из узлов сети на протяжении всего маршрута следования потока.

Чтобы добиться желаемого результата, достаточно организовать для выходного интерфейса две взвешенные очереди — очередь для зарезервированного потока с весом 25 % и очередь «по умолчанию» для всех остальных потоков.
Кроме того, необходимо активизировать **классификатор**, который будет проверять пакеты на всех входных интерфейсах устройства, отбирать пакеты нужного потока по заданным при резервировании признакам и направлять их в соответствующую очередь.

Для той же цели можно задействовать приоритетные очереди. Применение приоритетной очереди может оказаться необходимым, если потоку, помимо определенного уровня пропускной способности, требуется обеспечить и минимально возможный уровень задержек пакетов. При использовании приоритетной очереди профилирование необходимо всегда, так как приоритетный механизм не обеспечивает ограничения скорости потока, что может позволить приоритетному потоку захватить весь ресурс.

## Инжиниринг трафика
Задачу выбора маршрутов для потоков (или классов трафика) с учетом требований QoS решают **методы инжиниринга трафика** (Traffic Engineering). С помощью этих методов стремятся по возможности сбалансированно загрузить все ресурсы сети, чтобы сеть при заданном уровне качества обслуживания обладала как можно более высокой суммарной производительностью.

### Недостатки традиционных методов маршрутизации
Для каждой пары «адрес источника — адрес назначения» такие протоколы выбирают единственный маршрут, не принимая во внимание информационные потоки, протекающие через сеть. В результате все потоки между парами конечных узлов сети идут по кратчайшему (в соответствии с некоторой метрикой) маршруту.

### Методы инжиниринга трафика
Исходными данными для методов инжиниринга трафика являются:
* характеристики передающей сети;
* сведения о предложенной нагрузке сети.
К **характеристикам передающей сети** относится ее топология, а также производительность составляющих ее коммутаторов и линий связи. Предполагается, что производительность процессора каждого коммутатора достаточна для обслуживания трафика всех его входных интерфейсов, даже если трафик поступает на интерфейс с максимально возможной скоростью, равной пропускной способности интерфейса. При таких условиях в качестве резервируемых ресурсов выступает пропускная способность линий связи между коммутаторами.

**Сведения о предложенной нагрузке сети** представляют собой информацию о потоках данных, которые сеть должна передать между своими пограничными коммутаторами. Каждый поток характеризуется точкой входа в сеть, точкой выхода из сети и профилем трафика.

Методы инжиниринга трафика чаще применяют не к отдельным, а к агрегированным потокам, которые являются объединением нескольких потоков. Так как мы ищем общий маршрут для нескольких потоков, то агрегировать можно только потоки, имеющие общие точки входа в сеть и выхода из сети. Агрегированное задание потоков позволяет упростить задачу выбора путей, так как при индивидуальном рассмотрении каждого пользовательского потока промежуточные коммутаторы должны хранить слишком большие объемы информации. Агрегирование отдельных потоков в один возможно только в том случае, когда все потоки, составляющие агрегированный поток, предъявляют одни и те же требования к качеству обслуживания.

**Решением задачи инжиниринга трафика** является такой набор маршрутов для заданного множества потоков трафика, для которого все значения коэффициентов загрузки ресурсов вдоль маршрута следования каждого потока не превышают некоторого заданного порога Kmax.

Максимальный уровень использования ресурсов Kmax выбирается таким образом, чтобы механизмы управления перегрузкой могли обеспечить требуемое качество обслуживания.
Это означает, что для эластичного трафика максимальное значение выбирается не больше чем 0,9, а для чувствительного к задержкам трафика — не больше чем 0,5.
Так как обычно резервирование производится не для всех потоков, нужно оставить часть пропускной способности для свободного использования. Поэтому приведенные максимальные значения обычно уменьшают до 0,75 и 0,25 соответственно.

Решение задачи инжиниринга трафика можно искать заблаговременно, в фоновом режиме. Для этих целей должна быть разработана внешняя по отношению к сети программа, исходными данными для которой служат топология и производительность сети, а также предложенная нагрузка. Эта программа ищет оптимальное распределение маршрутов, например, путем направленного перебора вариантов.

## Работа в недогруженном режиме
Говорят, что сеть имеет избыточную пропускную способность, когда все части сети в любой момент времени обладают такой пропускной способностью, которой достаточно, чтобы обслужить все потоки трафика, протекающего в это время через сеть, с удовлетворительными характеристиками производительности и надежности. Другими словами, ни одно из сетевых устройств такой сети никогда не подвергается перегрузкам, которые могли бы привести к значительным задержкам или потерям пакетов из-за переполнения очередей пакетов.

Обычно операторы, которые хотят поддерживать свою сеть в недогруженном состоянии и за счет этого обеспечивать высокое качество обслуживания, просто осуществляют мониторинг уровня трафика в линиях связи сети, то есть *измеряют коэффициент использования пропускной способности линий связи*. При этом линия связи считается недогруженной, если ее коэффициент использования постоянно не превосходит некоторый достаточно низкий уровень, например 20–30%. Имея такие значения измерений, можно считать, что линия в среднем не испытывает перегрузок, а, значит, сеть будет передавать трафик качественно.

Для автоматического резервирования ресурсов маршрутизаторов (таких как пропускная способность интерфейсов, размеры буферов) в пределах, разрешенных политикой QoS для данной сети, в начале 90-х годов был разработан **протокол резервирования ресурсов (Resource reSerVation Protocol, RSVP)**. Этот протокол принимает запрос на резервирования ресурсов от приложения, работающего на узле сети, генерирующего некоторого поток пакетов. В запросе указываются параметры, рекомендуемые для качественной передачи сетью трафика этого приложения: верхнюю и нижнюю границы требуемой пропускной способности, максимальные значения задержки и ее вариации и т. п. Запрос передается в пакете протокола RSVP всем маршрутизаторам, расположенным вдоль пути потока между конечными узлами пути потока.

# Part 2. Технологии физического уровня
# Chapter 6. Линии связи.
## Классификация линий связи
### Первичные сети, линии и каналы связи
* **Звено (link)** — это сегмент, обеспечивающий передачу данных между двумя соседними узлами сети. Звено не содержит промежуточных устройств коммутации и мультиплексирования, но может включать усилители и регенераторы сигналов.
* **Каналом (channel)** чаще всего обозначают часть пропускной способности звена, используемую независимо при коммутации. Например, звено первичной сети может состоять из 30 каналов, каждый из которых обладает пропускной способностью 64 Кбит/с.
* **Составной канал (circuit)** — это путь между двумя конечными узлами сети. Составной канал образуется отдельными каналами промежуточных звеньев и внутренними соединениями в коммутаторах. Часто эпитет «составной» опускается, и термином «канал» называют как составной канал, так и канал между соседними узлами, то есть в пределах звена.
* **Линия связи** может использоваться как синоним для любого из трех остальных терминов.

**Первичные сети** специально создаются для того, чтобы предоставлять услуги каналов передачи данных для компьютерных и телефонных сетей, про которые в таких случаях говорят, что они работают «поверх» первичных сетей и являются **наложенными сетями**.

### Физическая среда передачи данных
Для передачи информации в компьютерных сетях используются **электромагнитные колебания** — взаимосвязанные колебания электрического и магнитного полей.
Частным случаем электромагнитных колебаний являются **электрические колебания**, когда рассматриваются колебания только электрических величин: силы тока, напряжения, заряда.
Электромагнитные колебания могут распространяться в различных средах, которые делятся на два класса:
* **Направленные среды**, или проводные среды. В этом случае электромагнитные волны перемещаются по физически ограниченному пути, например, по медному проводнику (передача электрического напряжения/тока) или волоконно-оптическому волокну. На основе таких проводников строятся проводные (воздушные) или кабельные линии связи.
* **Ненаправленные среды**, или беспроводные среды. Электромагнитные волны распространяются свободно в среде, пропускающей электромагнитное излучение: в земной атмосфере, космическом пространстве, воде, грунте и т. п.

**Проводные (воздушные) линии связи** представляют собой провода без каких-либо изолирующих или экранирующих оплеток, проложенные между столбами и висящие в воздухе.

**Кабельные линии** имеют достаточно сложную конструкцию. Кабель состоит из набора проводников, заключенных в несколько слоев **изоляции**: электрической, электромагнитной, механической и, возможно, климатической. Кроме того, кабель может быть оснащен **разъемами**, позволяющими быстро выполнять присоединение к нему различного оборудования.

В компьютерных (и телекоммуникационных) сетях применяются три основных типа кабеля.
Первые два типа кабелей — **витую пару и коаксиальный кабель** — называют также медными кабелями.
**Волоконно-оптические** кабели обладают широкой полосой пропускания и низкой чувствительностью к помехам. На них сегодня строятся как магистрали крупных территориальных и городских сетей, так и высокоскоростные локальные сети.
**Радиоканалы** наземной и спутниковой связи образуются с помощью передатчика и приемника радиоволн.

### Аппаратура передачи данных
Линии связи состоят не только из среды передачи, но и **аппаратуры**. Даже в том случае, когда линия связи не проходит через первичную сеть, а основана на кабеле, в ее состав входит аппаратура передачи данных.

**Аппаратура передачи данных (Data Circuit-terminating Equipment, DCE)** в компьютерных сетях непосредственно присоединяет компьютеры или коммутаторы к линиям связи и является, таким образом, *пограничным, или оконечным*, оборудованием линии связи. Примерами DCE являются модемы (для телефонных линий) и устройства для подключения к цифровым каналам первичных сетей. DCE работает на физическом уровне модели OSI, отвечая за кодирование и передачу информации в физическую среду (в линию) и прием из нее сигналов нужной формы, мощности и частоты.
Аппаратура пользователя линии связи, вырабатывающая данные для передачи по линии связи и подключаемая непосредственно к аппаратуре передачи данных, носит обобщенное название **оконечное оборудование данных (Data Terminal Equipment, DTE)**. Примером DTE могут служить компьютеры, коммутаторы и маршрутизаторы. Эту аппаратуру не включают в состав линии связи. Устройства DCE и DTE обычно располагаются на коротких расстояниях друг от друга.

Помимо оконечной аппаратуры DCE в линию связи может входить **промежуточная аппаратура**. Она решает две основные задачи:
* улучшение качества сигнала;
* создание постоянного составного канала связи между двумя абонентами сети.
В локальных сетях промежуточная аппаратура может совсем не использоваться, если протяженность физической среды — кабелей или радиоэфира — позволяет одному сетевому адаптеру принимать сигналы непосредственно от другого сетевого адаптера без дополнительного усиления. В противном случае применяется промежуточная аппаратура, роль которой здесь играют устройства типа **повторителей и концентраторов**.
В глобальных сетях необходимо обеспечить качественную передачу сигналов на расстояния в сотни и тысячи километров. Поэтому без **усилителей** (повышающих мощность сигналов) и **регенераторов** (наряду с повышением мощности восстанавливающих форму импульсных сигналов, исказившихся при передаче на большое расстояние), установленных через определенные расстояния, построить территориальную линию связи невозможно.
В первичных сетях, помимо упомянутого оборудования, обеспечивающего качественную передачу сигналов, необходима промежуточная коммутационная аппаратура — **мультиплексоры, демультиплексоры и кросс-коннекторы (коммутаторы)**. Эта аппаратура создает между двумя абонентами сети постоянный составной канал из отрезков физической среды — кабелей с усилителями.

В зависимости от типа промежуточной аппаратуры все линии связи делятся на **аналоговые и цифровые**.
**В аналоговых линиях** промежуточная аппаратура предназначена для усиления аналоговых сигналов, то есть сигналов, которые имеют непрерывный диапазон значений.

Для создания высокоскоростных каналов, которые мультиплексируют несколько низкоскоростных аналоговых абонентских каналов, при аналоговом подходе обычно используется **техника частотного мультиплексирования (Frequency Division Multiplexing, FDM)**.

**В цифровых линиях** связи передаваемые сигналы имеют конечное число состояний, то есть являются дискретными.

Как правило, элементарный сигнал, то есть сигнал, передаваемый за один такт работы передающей аппаратуры, имеет 2, 3 или 4 состояния, которые в линиях связи воспроизводятся импульсами или потенциалами прямоугольной формы.
С помощью таких сигналов передаются как компьютерные данные, так и оцифрованные речь и изображение (именно благодаря одинаковому способу представления информации современными компьютерными, телефонными и телевизионными сетями стало возможным появление общих для всех первичных сетей). В цифровых линиях связи используется специальная промежуточная аппаратура — **регенераторы**, которые улучшают форму импульсов и восстанавливают период их следования. Промежуточная цифровая аппаратура мультиплексирования и коммутации первичных сетей работает по принципу **временного мультиплексирования каналов (Time Division Multiplexing, TDM)**.

## Характеристики линий связи
### Спектральное представление сигнала
Качество передачи данных по линиям связи определяется как характеристиками передаваемых сигналов (мощность, способ кодирования и др.), так и характеристиками линий связи, к которым относятся: затухание; ограниченность полосы пропускания; помехозащищенность и др.

**Затухание** показывает, насколько уменьшается мощность эталонного синусоидального сигнала на выходе линии связи по отношению к мощности сигнала на входе этой линии.

Величина опорной мощности y выходного сигнала, являющаяся минимальной опорной мощностью сигнала на входе приемника, при котором он еще способен корректно распознавать дискретную информацию, содержащуюся в сигнале, называется **порогом чувствительности приемника**.

**Полоса пропускания (bandwidth)** — это непрерывный диапазон частот, для которого затухание не превышает некоторый заранее заданный предел. То есть полоса пропускания определяет диапазон частот синусоидального сигнала, при которых этот сигнал передается по линии связи без значительных искажений. Полоса пропускания измеряется в герцах (Гц).

**Электромагнитная помеха** — это нежелательное воздействие на передаваемый сигнал, ухудшающее возможность его распознавания при приеме.

**Внешние помехи** создаются различными электрическими двигателями, электронными устройствами, атмосферными явлениями и т. д.
**Внутренние помехи** — это результат взаимного влияния электрических процессов в проводниках линии связи, так называемые перекрестные наводки одной пары проводников на другую.

Передача дискретной информации в телекоммуникационных сетях осуществляется тактированно, то есть изменение информационного параметра сигнала происходит через фиксированный интервал времени, называемый **тактом**.
Величина, обратная значению такта, является **тактовой частотой линии**.

## Проводные линии связи
Сегодня как для внутренней проводки (кабели зданий), так и для внешней чаще всего применяются три класса проводных линий связи:
* экранированная и неэкранированная витая пара;
* коаксиальные кабели;
* волоконно-оптические кабели.

### Экранированная и неэкранированная витая пара
**Витой парой** называется скрученная пара проводов. Этот вид среды передачи данных очень популярен и составляет основу большого количества как внутренних, так и внешних кабелей. Кабель может состоять из нескольких скрученных пар (внешние кабели иногда содержат до нескольких десятков таких пар).
Скручивание проводов снижает влияние внешних и взаимных помех на полезные сигналы, передаваемые по кабелю.

**Экранированная витая пара (Shielded Twisted Pair, STP)** хорошо защищает передаваемые сигналы от внешних помех, а также меньше излучает электромагнитные колебания вовне.

**Неэкранированная витая пара (Unshielded Twisted Pair, UTP)** обеспечивает защиту от внешних помех только за счет скручивания проводов в пары, что, естественно, не является такой эффективной мерой, как экранирование, но во многих случаях оказывается достаточной для передачи данных с нужным качеством.

### Коаксиальный кабель
**Коаксиальный кабель** состоит из несимметричных пар проводников. Каждая пара представляет собой внутреннюю медную жилу и соосную с ней внешнюю жилу, которая может быть полой медной трубой или оплеткой, отделенной от внутренней жилы диэлектрической изоляцией. Внешняя жила играет двоякую роль — по ней передаются информационные сигналы, и она является экраном, защищающим внутреннюю жилу от внешних электромагнитных полей.

### Структурированная кабельная система зданий
**Структурированная кабельная система (Structured Cabling System)** здания — это набор коммутационных элементов (кабелей, разъемов, коннекторов, кроссовых панелей и шкафов), а также методика их совместного использования, которая позволяет создавать регулярные легко расширяемые структуры связей в вычислительных сетях.

Типичная структурированная кабельная система строится по иерархическому принципу, включая:
* **горизонтальные подсистемы**, соответствующие этажам здания, — они соединяют кроссовые шкафы этажа с розетками пользователей;
* **вертикальные подсистемы**, соединяющие кроссовые шкафы каждого этажа с центральной аппаратной здания;
* **подсистему кампуса**, объединяющую несколько зданий с главной аппаратной всего кампуса или иного комплекса зданий (эта часть кабельной системы обычно называется магистралью).


